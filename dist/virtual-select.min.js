/*!
 * Virtual Select v1.0.6
 * https://sa-si-dev.github.io/virtual-select
 * Licensed under MIT (https://github.com/sa-si-dev/virtual-select/blob/master/LICENSE)
 */(()=>{"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var o=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var o,n,l;return o=t,l=[{key:"getString",value:function(e){return void 0!==e||null!==e||0===e?e.toString():""}},{key:"convertToBoolean",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e=!0===e||"true"===e||!1!==e&&"false"!==e&&t}},{key:"isEmpty",value:function(e){var t=!1;return e?Array.isArray(e)?0===e.length&&(t=!0):"object"===i(e)&&0===Object.keys(e).length&&(t=!0):t=!0,t}},{key:"isNotEmpty",value:function(e){return!this.isEmpty(e)}},{key:"removeItemFromArray",value:function(t,i,s){if(!Array.isArray(t)||!t.length)return t;s&&(t=e(t));var o=t.indexOf(i);return-1!==o&&t.splice(o,1),t}},{key:"removeArrayEmpty",value:function(e){return Array.isArray(e)&&e.length?e.filter((function(e){return!!e})):[]}},{key:"generateUUID",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}}],(n=null)&&s(o.prototype,n),l&&s(o,l),t}();function n(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function a(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,s;return t=e,s=[{key:"addClass",value:function(t,i){t&&(i=i.split(" "),e.getElements(t).forEach((function(e){var t;(t=e.classList).add.apply(t,n(i))})))}},{key:"removeClass",value:function(t,i){t&&(i=i.split(" "),e.getElements(t).forEach((function(e){var t;(t=e.classList).remove.apply(t,n(i))})))}},{key:"toggleClass",value:function(t,i,s){var o;if(t)return void 0!==s&&(s=Boolean(s)),e.getElements(t).forEach((function(e){o=e.classList.toggle(i,s)})),o}},{key:"hasClass",value:function(e,t){return!!e&&e.classList.contains(t)}},{key:"hasEllipsis",value:function(e){return!!e&&e.scrollWidth>e.offsetWidth}},{key:"getData",value:function(e,t,i){if(e){var s=e?e.dataset[t]:"";return"number"===i&&(s=parseFloat(s)||0),s}}},{key:"setData",value:function(e,t,i){e&&(e.dataset[t]=i)}},{key:"setAttr",value:function(e,t,i){e&&e.setAttribute(t,i)}},{key:"setAttrFromEle",value:function(e,t,i,s){var o={};i.forEach((function(t){o[t]=e.getAttribute(t)})),i.forEach((function(e){var i=o[e];(i||-1!==s.indexOf(e)&&""===i)&&t.setAttribute(e,i)}))}},{key:"setStyle",value:function(e,t,i){e&&(e.style[t]=i)}},{key:"setStyles",value:function(e,t){e&&t&&Object.keys(t).forEach((function(i){e.style[i]=t[i]}))}},{key:"getElements",value:function(e){if(e)return void 0===e.forEach&&(e=[e]),e}},{key:"addEvent",value:function(t,i,s){t&&(i=o.removeArrayEmpty(i.split(" "))).forEach((function(i){(t=e.getElements(t)).forEach((function(e){e.addEventListener(i,s)}))}))}},{key:"dispatchEvent",value:function(t,i){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(t=e.getElements(t),setTimeout((function(){t.forEach((function(e){e.dispatchEvent(new CustomEvent(i,{bubbles:s}))}))}),0))}},{key:"getAttributesText",value:function(e){var t="";if(!e)return t;for(var i in e){var s=e[i];void 0!==s&&(t+=" ".concat(i,'="').concat(s,'" '))}return t}},{key:"getStyleText",value:function(e,t){var i="";for(var s in e)i+="".concat(s,": ").concat(e[s],";");return i&&!t&&(i='style="'.concat(i,'"')),i}},{key:"getMoreVisibleSides",value:function(e){if(!e)return{};var t=e.getBoundingClientRect(),i=window.innerWidth,s=window.innerHeight,o=t.left,n=t.top;return{horizontal:o>i-o-t.width?"left":"right",vertical:n>s-n-t.height?"top":"bottom"}}}],(i=null)&&a(t.prototype,i),s&&a(t,s),e}();function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=h(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0,o=function(){};return{s:o,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,a=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return l=e.done,e},e:function(e){a=!0,n=e},f:function(){try{l||null==i.return||i.return()}finally{if(a)throw n}}}}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}function v(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var f="{#virtual-select-none-option#}",y={13:"onEnterPress",27:"onEscPress",38:"onUpArrowPress",40:"onDownArrowPress"},g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);try{this.setProps(t),this.setDisabledOptions(t.disabledOptions),this.setOptions(t.options),this.render()}catch(e){console.warn("Couldn't initiate Virtual Select"),console.error(e)}}var t,i,s;return t=e,s=[{key:"init",value:function(t){var i=t.ele;if(i){var s=!1;if("string"!=typeof i||(i=document.querySelector(i))){void 0===i.length&&(i=[i],s=!0);var o=[];return i.forEach((function(i){t.ele=i,o.push(new e(t))})),s?o[0]:o}}}},{key:"resetForm",value:function(e){var t=e.target.closest("form");t&&t.querySelectorAll(".vscomp-wrapper").forEach((function(e){e.parentElement.virtualSelect.reset()}))}},{key:"reset",value:function(){this.virtualSelect.reset()}},{key:"setValueMethod",value:function(e,t){this.virtualSelect.setValueMethod(e,t)}},{key:"setOptionsMethod",value:function(e,t){this.virtualSelect.setOptionsMethod(e,t)}},{key:"setDisabledOptionsMethod",value:function(e){this.virtualSelect.setDisabledOptionsMethod(e)}},{key:"toggleSelectAll",value:function(e){this.virtualSelect.toggleAllOptions(e)}},{key:"isAllSelected",value:function(){return this.virtualSelect.isAllSelected}},{key:"addOptionMethod",value:function(e){this.virtualSelect.addOption(e,!0)}},{key:"getNewValueMethod",value:function(){return this.virtualSelect.getNewValue()}},{key:"version",value:function(){return"v1.0.6"}},{key:"getDisplayValueMethod",value:function(){return this.virtualSelect.getDisplayValue()}},{key:"getSelectedOptionsMethod",value:function(){return this.virtualSelect.getSelectedOptions()}},{key:"openMethod",value:function(){return this.virtualSelect.openDropbox()}},{key:"closeMethod",value:function(){return this.virtualSelect.closeDropbox()}},{key:"setSearchValueMethod",value:function(e){return this.virtualSelect.setSearchValue(e)}},{key:"onResizeMethod",value:function(){document.querySelectorAll(".vscomp-wrapper").forEach((function(e){e.parentElement.virtualSelect.onResize()}))}}],(i=[{key:"render",value:function(){var e=this;if(this.$ele){var t="vscomp-wrapper",i=this.getTooltipAttrText("",!this.multiple,!0),s=this.getTooltipAttrText("Clear"),n={"z-index":this.zIndex},l=function(){var t="";return e.additionalClasses&&(t+=" "+e.additionalClasses),e.multiple&&(t+=" multiple",e.disableSelectAll||(t+=" has-select-all")),"top"===e.position&&(t+=" position-top"),e.hideClearButton||(t+=" has-clear-button"),e.keepAlwaysOpen?t+=" keep-always-open opened":t+=" closed",e.showAsPopup?t+=" show-as-popup":e.dropboxWidth&&(n.width=e.dropboxWidth),e.hasSearch&&(t+=" has-search-input"),t};t+=l(),this.guid=o.generateUUID();var a='<div id="vs-'.concat(this.guid,'" class="vscomp-dropbox-container" ').concat(r.getStyleText(n),'>\n      <div class="vscomp-dropbox">\n        <div class="vscomp-search-wrapper"></div>\n\n        <div class="vscomp-options-container">\n          <div class="vscomp-options-loader"></div>\n\n          <div class="vscomp-options-list">\n            <div class="vscomp-options"></div>\n          </div>\n        </div>\n\n        <div class="vscomp-no-options">').concat(this.noOptionsText,'</div>\n        <div class="vscomp-no-search-results">').concat(this.noSearchResultsText,'</div>\n\n        <span class="vscomp-dropbox-close-button"><i class="vscomp-clear-icon"></i></span>\n      </div>\n    </div>'),p='<div class="'.concat(t,'" tabindex="0">\n        <input type="hidden" name="').concat(this.name,'" class="vscomp-hidden-input">\n\n        <div class="vscomp-toggle-button">\n          <div class="vscomp-value" ').concat(i,">\n            ").concat(this.placeholder,'\n          </div>\n\n          <div class="vscomp-arrow"></div>\n\n          <div class="vscomp-clear-button toggle-button-child" ').concat(s,'>\n            <i class="vscomp-clear-icon"></i>\n          </div>\n        </div>\n\n        ').concat(this.keepAlwaysOpen||!this.appendToBody?a:"","\n\n      </div>");if(this.$ele.innerHTML=p,this.$body=document.querySelector("body"),this.$wrapper=this.$ele.querySelector(".vscomp-wrapper"),this.$toggleButton=this.$ele.querySelector(".vscomp-toggle-button"),this.$clearButton=this.$ele.querySelector(".vscomp-clear-button"),this.$dropboxCloseButton=this.$ele.querySelector(".vscomp-dropbox-close-button"),!this.keepAlwaysOpen&&this.appendToBody){this.$body.append(document.createRange().createContextualFragment(a)),this.$dropboxContainer=document.querySelector("#vs-".concat(this.guid,".vscomp-dropbox-container")),this.$dropboxEl=document.querySelector("#vs-".concat(this.guid));var c="vscomp-wrapper-body";c+=l(),r.addClass(this.$dropboxEl,"".concat(c))}else this.$dropboxContainer=this.$ele.querySelector(".vscomp-dropbox-container"),this.$dropboxEl=this.$ele;this.$search=this.$dropboxEl.querySelector(".vscomp-search-wrapper"),this.$optionsContainer=this.$dropboxEl.querySelector(".vscomp-options-container"),this.$optionsList=this.$dropboxEl.querySelector(".vscomp-options-list"),this.$options=this.$dropboxEl.querySelector(".vscomp-options"),this.$valueText=this.$ele.querySelector(".vscomp-value"),this.$hiddenInput=this.$ele.querySelector(".vscomp-hidden-input"),this.$noOptions=this.$dropboxEl.querySelector(".vscomp-no-options"),this.$noSearchResults=this.$dropboxEl.querySelector(".vscomp-no-search-results"),this.afterRenderWrapper()}}},{key:"renderOptions",value:function(){var e,t=this,i="",s=this.getVisibleOptions(),o="",n="",l=!(!this.markSearchResults||!this.searchValue),a=r.getStyleText({height:this.optionHeight+"px"});if(l&&(e=new RegExp("(".concat(this.searchValue,")"),"gi")),this.multiple&&(o='<span class="checkbox-icon"></span>'),this.allowNewOption){var p=this.getTooltipAttrText("New Option");n='<span class="vscomp-new-option-icon" '.concat(p,"></span>")}s.forEach((function(s){var r=s.label,p="vscomp-option",c=t.getTooltipAttrText("",!0),u=o,h="",d="";s.isFocused&&(p+=" focused"),s.isDisabled&&(p+=" disabled"),s.isGroupTitle?(p+=" group-title",u=""):s.isSelected&&(p+=" selected"),s.isGroupOption&&(p+=" group-option"),s.description&&(d='<div class="vscomp-option-description" '.concat(c,">").concat(s.description,"</div>")),s.isCurrentNew?(p+=" current-new",h+=n):l&&!s.isGroupTitle&&(r=r.replace(e,"<mark>$1</mark>")),i+='<div class="'.concat(p,'" data-value="').concat(s.value,'" data-index="').concat(s.index,'" data-visible-index="').concat(s.visibleIndex,'" ').concat(a,">\n          ").concat(u,'\n          <span title="').concat(r,'" class="vscomp-option-text ').concat(s.value===f?"none":"",'" ').concat(c,">\n            ").concat(r,"\n          </span>\n          ").concat(d,"\n          ").concat(h,"\n        </div>")})),this.$options.innerHTML=i;var c=!this.options.length,u=!c&&!s.length;this.allowNewOption||(r.toggleClass(this.$wrapper,"has-no-search-results",u),this.appendToBody&&r.toggleClass(this.$dropboxEl,"has-no-search-results",u)),r.toggleClass(this.$wrapper,"has-no-options",c),this.setOptionsPosition(),this.setOptionsTooltip()}},{key:"renderSearch",value:function(){if(this.hasSearchContainer){var e="",t="";this.hasSearch&&(t=' <div class="vscomp-search-container">\n          <input type="text" class="vscomp-search-input" placeholder="'.concat(this.searchPlaceholder,'">\n          <span class="vscomp-search-clear">&times;</span>\n        </div>')),this.multiple&&!this.disableSelectAll&&(e='<div class="vs-comp-select-all-container">\n        <span class="vscomp-toggle-all-button">\n          <span class="checkbox-icon vscomp-toggle-all-checkbox"></span>\n          <span class="vscomp-toggle-all-label">'.concat(this.selectAllText,"</span>\n        </span>\n        </div>"));var i="".concat(t).concat(e);this.$search.innerHTML=i,this.$searchInput=this.$dropboxEl.querySelector(".vscomp-search-input"),this.$searchClear=this.$dropboxEl.querySelector(".vscomp-search-clear"),this.$toggleAllButton=this.$dropboxEl.querySelector(".vscomp-toggle-all-button"),this.$toggleAllCheckbox=this.$dropboxEl.querySelector(".vscomp-toggle-all-checkbox"),this.addEvent(this.$searchInput,"keyup change","onSearch"),this.addEvent(this.$searchClear,"click","onSearchClear"),this.addEvent(this.$toggleAllButton,"click","onToggleAllOptions")}}},{key:"addEvents",value:function(){this.addEvent(document,"click","onDocumentClick"),this.addEvent(this.$wrapper,"keydown","onKeyDown"),this.addEvent(this.$toggleButton,"click","onToggleButtonClick"),this.addEvent(this.$clearButton,"click","onClearButtonClick"),this.addEvent(this.$dropboxContainer,"click","onDropboxContainerClick"),this.addEvent(this.$dropboxCloseButton,"click","onDropboxCloseButtonClick"),this.addEvent(this.$optionsContainer,"scroll","onOptionsScroll"),this.addEvent(this.$options,"click","onOptionsClick"),this.addEvent(this.$options,"mouseover","onOptionsMouseOver"),this.addEvent(this.$dropboxContainer,"mouseleave","onOptionsMouseLeave"),this.addEvent(this.$options,"touchmove","onOptionsTouchMove")}},{key:"onOptionsMouseLeave",value:function(){this.removeOptionFocus()}},{key:"addEvent",value:function(e,t,i){var s=this;e&&(t=o.removeArrayEmpty(t.split(" "))).forEach((function(t){var o="".concat(i,"-").concat(t),n=s.events[o];n||(n=s[i].bind(s),s.events[o]=n),(e=r.getElements(e)).forEach((function(e){e.addEventListener(t,n)}))}))}},{key:"dispatchEvent",value:function(e,t){e&&(e=r.getElements(e),setTimeout((function(){e.forEach((function(e){e.dispatchEvent(new Event(t,{bubbles:!0}))}))}),0))}},{key:"onDocumentClick",value:function(e){this.appendToBody&&this.multiple&&this.isOpened()&&e.target.closest("#vs-".concat(this.guid))||e.target.closest(".vscomp-wrapper")!==this.$wrapper&&this.closeDropbox()}},{key:"onKeyDown",value:function(e){var t=e.which||e.keyCode,i=y[t];i&&this[i](e)}},{key:"onEnterPress",value:function(){this.isOpened()?this.selectFocusedOption():this.openDropbox()}},{key:"onEscPress",value:function(){this.isOpened()&&this.closeDropbox()}},{key:"onDownArrowPress",value:function(e){e.preventDefault(),this.isOpened()?this.focusOption("next"):this.openDropbox()}},{key:"onUpArrowPress",value:function(e){e.preventDefault(),this.isOpened()?this.focusOption("previous"):this.openDropbox()}},{key:"onToggleButtonClick",value:function(e){e.target.closest(".toggle-button-child")||this.toggleDropbox()}},{key:"onClearButtonClick",value:function(){this.reset()}},{key:"onOptionsScroll",value:function(){this.setVisibleOptions()}},{key:"onOptionsClick",value:function(e){if(this.selectOption(e.target.closest(".vscomp-option:not(.disabled):not(.group-title)")),this.multiple&&this.showSelectedOptionsFirst)return e.stopPropagation(),!1}},{key:"onDropboxContainerClick",value:function(e){e.target.closest(".vscomp-dropbox")||this.closeDropbox()}},{key:"onDropboxCloseButtonClick",value:function(){this.closeDropbox()}},{key:"onOptionsMouseOver",value:function(e){var t=e.target.closest(".vscomp-option:not(.disabled):not(.group-title)");t&&this.isOpened()&&this.focusOption(null,t)}},{key:"onOptionsTouchMove",value:function(){this.removeOptionFocus()}},{key:"onSearch",value:function(e){e.stopPropagation(),this.setSearchValue(e.target.value,!0)}},{key:"onSearchClear",value:function(){this.setSearchValue(""),this.focusSearchInput()}},{key:"onToggleAllOptions",value:function(){this.toggleAllOptions()}},{key:"onResize",value:function(){this.appendToBody?this.isOpened()&&this.closeDropbox(!0):this.setOptionsContainerHeight(!0)}},{key:"beforeValueSet",value:function(e){this.toggleAllOptionsClass(!e&&void 0)}},{key:"beforeSelectNewValue",value:function(){var e=this,t=this.getNewOption(),i=t.index;this.newValues.push(t.value),this.setOptionProp(i,"isCurrentNew",!1),this.setOptionProp(i,"isNew",!0),setTimeout((function(){e.setSearchValue(""),e.focusSearchInput()}),0)}},{key:"afterRenderWrapper",value:function(){this.$ele.setAttribute("name",this.name),r.addClass(this.$ele,"vscomp-ele"),this.renderSearch(),this.setOptionsHeight(),this.setVisibleOptions(),this.setOptionsContainerHeight(),this.addEvents(),this.setMethods(),void 0!==this.initialSelectedValue||null!==this.initialSelectedValue?this.setValueMethod(this.initialSelectedValue,this.silentInitialValueSet):this.autoSelectFirstOption&&this.visibleOptions.length&&this.setValueMethod(this.visibleOptions[0].value,this.silentInitialValueSet)}},{key:"afterSetOptionsContainerHeight",value:function(e){e&&this.showAsPopup&&this.setVisibleOptions()}},{key:"afterSetSearchValue",value:function(){this.hasServerSearch?this.serverSearch():this.setVisibleOptionsCount(),this.selectAllOnlyVisible&&this.toggleAllOptionsClass()}},{key:"afterSetVisibleOptionsCount",value:function(){this.scrollToTop(),this.setOptionsHeight(),this.setVisibleOptions()}},{key:"afterValueSet",value:function(){this.scrollToTop(),this.setSearchValue(""),this.renderOptions()}},{key:"afterSetOptions",value:function(e){e&&this.setSelectedProp(),this.setOptionsHeight(),this.setVisibleOptions(),this.showOptionsOnlyOnSearch&&this.setSearchValue("",!1,!0),e||this.reset()}},{key:"setProps",value:function(e){e=this.setDefaultProps(e),this.setPropsFromElementAttr(e);var t=o.convertToBoolean;this.$ele=e.ele,this.valueKey=e.valueKey,this.labelKey=e.labelKey,this.descriptionKey=e.descriptionKey,this.aliasKey=e.aliasKey,this.optionHeightText=e.optionHeight,this.optionHeight=parseFloat(this.optionHeightText),this.multiple=t(e.multiple),this.hasSearch=t(e.search),this.hideClearButton=t(e.hideClearButton),this.autoSelectFirstOption=t(e.autoSelectFirstOption),this.hasOptionDescription=t(e.hasOptionDescription),this.silentInitialValueSet=t(e.silentInitialValueSet),this.allowNewOption=t(e.allowNewOption),this.markSearchResults=t(e.markSearchResults),this.showSelectedOptionsFirst=t(e.showSelectedOptionsFirst),this.disableSelectAll=t(e.disableSelectAll),this.keepAlwaysOpen=t(e.keepAlwaysOpen),this.showDropboxAsPopup=t(e.showDropboxAsPopup),this.selectAllOnlyVisible=t(e.selectAllOnlyVisible),this.noOptionsText=e.noOptionsText,this.noSearchResultsText=e.noSearchResultsText,this.selectAllText=e.selectAllText,this.placeholder=e.placeholder,this.position=e.position,this.dropboxWidth=e.dropboxWidth,this.tooltipFontSize=e.tooltipFontSize,this.tooltipAlignment=e.tooltipAlignment,this.tooltipMaxWidth=e.tooltipMaxWidth,this.noOfDisplayValues=parseInt(e.noOfDisplayValues),this.zIndex=parseInt(e.zIndex),this.maxValues=parseInt(e.maxValues),this.name=e.name,this.additionalClasses=e.additionalClasses,this.initialSelectedValue=e.selectedValue,this.popupDropboxBreakpoint=e.popupDropboxBreakpoint,this.onServerSearch=e.onServerSearch,this.searchPlaceholder=e.searchPlaceholder,this.itemsSelectedMessage=e.itemsSelectedMessage,this.allowNoneOption=e.allowNoneOption,this.noneOptionText=e.noneOptionText,this.appendToBody=e.appendToBody,this.selectedValues=[],this.selectedIndexes=[],this.selectedOptions=[],this.newValues=[],this.events={},this.tooltipEnterDelay=200,this.transitionDuration=250,this.searchValue="",this.searchValueOriginal="",this.isAllSelected=!1,(void 0===e.search&&this.multiple||this.allowNewOption)&&(this.hasSearch=!0),this.maxValues&&(this.disableSelectAll=!0),this.hasServerSearch="function"==typeof this.onServerSearch,this.showAsPopup=this.showDropboxAsPopup&&!this.keepAlwaysOpen&&window.innerWidth<=parseFloat(this.popupDropboxBreakpoint),this.hasSearchContainer=this.hasSearch||this.multiple&&!this.disableSelectAll,this.optionsCount=this.getOptionsCount(e.optionsCount),this.halfOptionsCount=Math.ceil(this.optionsCount/2),this.optionsHeight=this.getOptionsHeight()}},{key:"setDefaultProps",value:function(e){var t={valueKey:"value",labelKey:"label",descriptionKey:"description",aliasKey:"alias",optionsCount:5,noOfDisplayValues:50,optionHeight:"40px",multiple:!1,hideClearButton:!1,autoSelectFirstOption:!1,hasOptionDescription:!1,silentInitialValueSet:!1,disableSelectAll:!1,noOptionsText:"No options found",noSearchResultsText:"No results found",selectAllText:"Select All",placeholder:"Select",position:"auto",zIndex:1,allowNewOption:!1,markSearchResults:!1,tooltipFontSize:"14px",tooltipAlignment:"center",tooltipMaxWidth:"300px",showSelectedOptionsFirst:!1,name:"",additionalClasses:"",keepAlwaysOpen:!1,maxValues:0,showDropboxAsPopup:!0,popupDropboxBreakpoint:"576px",searchPlaceholder:"Search...",itemsSelectedMessage:"selected",allowNoneOption:!1,noneOptionText:"None",appendToBody:!1,selectAllOnlyVisible:!0};return e.hasOptionDescription&&(t.optionsCount=4,t.optionHeight="60px"),Object.assign(t,e)}},{key:"setPropsFromElementAttr",value:function(e){var t=e.ele,i={multiple:"multiple",placeholder:"placeholder",name:"name","data-value-key":"valueKey","data-label-key":"labelKey","data-description-key":"descriptionKey","data-alias-key":"aliasKey","data-search":"search","data-hide-clear-button":"hideClearButton","data-auto-select-first-option":"autoSelectFirstOption","data-has-option-description":"hasOptionDescription","data-options-count":"optionsCount","data-option-height":"optionHeight","data-position":"position","data-no-options-text":"noOptionsText","data-no-search-results-text":"noSearchResultsText","data-select-all-text":"selectAllText","data-silent-initial-value-set":"silentInitialValueSet","data-dropbox-width":"dropboxWidth","data-z-index":"zIndex","data-no-of-display-values":"noOfDisplayValues","data-allow-new-option":"allowNewOption","data-mark-search-results":"markSearchResults","data-tooltip-font-size":"tooltipFontSize","data-tooltip-alignment":"tooltipAlignment","data-tooltip-max-width":"tooltipMaxWidth","data-show-selected-options-first":"showSelectedOptionsFirst","data-disable-select-all":"disableSelectAll","data-keep-always-open":"keepAlwaysOpen","data-max-values":"maxValues","data-additional-classes":"additionalClasses","data-show-dropbox-as-popup":"showDropboxAsPopup","data-popup-dropbox-breakpoint":"popupDropboxBreakpoint","data-select-all-only-visible":"selectAllOnlyVisible"};for(var s in i){var o=t.getAttribute(s);"multiple"!==s||""!==o&&"true"!==o||(o=!0),o&&(e[i[s]]=o)}}},{key:"setMethods",value:function(){var t=this.$ele;t.virtualSelect=this,t.value=this.multiple?[]:"",t.reset=e.reset,t.setValue=e.setValueMethod,t.setOptions=e.setOptionsMethod,t.setDisabledOptions=e.setDisabledOptionsMethod,t.toggleSelectAll=e.toggleSelectAll,t.isAllSelected=e.isAllSelected,t.addOption=e.addOptionMethod,t.getNewValue=e.getNewValueMethod,t.getDisplayValue=e.getDisplayValueMethod,t.open=e.openMethod,t.close=e.closeMethod,t.setSearchValue=e.setSearchValueMethod}},{key:"setValueMethod",value:function(e,t){Array.isArray(e)||(e=[e]),e=e.map((function(e){return e||0==e?e.toString():""}));var i,s=[],o=[],n=u(this.options);try{for(n.s();!(i=n.n()).done;){var l=i.value;if(-1===e.indexOf(l.value)||l.isDisabled||l.isGroupTitle)l.isSelected=!1;else{if(-1!==s.indexOf(l.value)&&this.multiple)break;if(l.isSelected=!0,s.push(l.value),o.push(l.index),!this.multiple)break}}}catch(e){n.e(e)}finally{n.f()}this.multiple||(s=s[0],o=o[0]),this.beforeValueSet(),this.setValue(s,o,!t),this.afterValueSet()}},{key:"setOptionsMethod",value:function(e,t){var i=e!=this.options;this.setOptions(e),this.afterSetOptions(t,i)}},{key:"setDisabledOptionsMethod",value:function(e){this.setDisabledOptions(e,!0),this.setValueMethod(null),this.setVisibleOptions()}},{key:"setDisabledOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.map((function(e){return e.toString()})),this.disabledOptions=e,t&&e.length&&this.options.forEach((function(t){return t.isDisabled=-1!==e.indexOf(t.value),t}))}},{key:"setOptions",value:function(e){e||(e=[]);var t=[],i=this.disabledOptions,s=i.length,n=this.valueKey,l=this.labelKey,a=this.descriptionKey,r=this.aliasKey,p=this.hasOptionDescription,c=o.getString,u=o.convertToBoolean,h=this.getAlias,d=0,v=!1;!this.multiple&&this.allowNoneOption&&e.unshift({value:f,label:this.noneOptionText}),e.forEach((function e(o){var f=c(o[n]),y=o.options,g=!!y,b={index:d,value:f,label:c(o[l]),alias:h(o[r]),isVisible:u(o.isVisible,!0),isGroupTitle:g};if(s&&(b.isDisabled=-1!==i.indexOf(f)),o.isGroupOption&&(b.isGroupOption=!0,b.groupIndex=o.groupIndex),p&&(b.description=c(o[a])),t.push(b),d++,g){var O=b.index;v=!0,y.forEach((function(t){t.isGroupOption=!0,t.groupIndex=O,e(t)}))}})),this.options=t,this.visibleOptionsCount=t.length,this.lastOptionIndex=this.options.length-1,this.newValues=[],this.hasOptionGroup=v,this.setSortedOptions()}},{key:"setServerOptions",value:function(e){var t=this;this.setOptionsMethod(e,!0);var i=this.selectedOptions,s=this.options,o=!1;if(i.length){var n=s.map((function(e){return e.value}));o=!0,i.forEach((function(e){-1===n.indexOf(e.value)&&(e.isVisible=!1,s.push(e))})),this.setOptionsMethod(s,!0)}this.allowNewOption&&this.searchValue&&(s.some((function(e){return e.label.toLowerCase()===t.searchValue}))||(o=!0,this.setNewOption())),o&&(this.setVisibleOptionsCount(),this.multiple&&this.toggleAllOptionsClass(),this.setValueText()),r.removeClass(this.$wrapper,"server-searching")}},{key:"setSelectedOptions",value:function(){var e=this.selectedValues;this.selectedOptions=this.options.filter((function(t){return-1!==e.indexOf(t.value)}))}},{key:"setSortedOptions",value:function(){var e=c(this.options);this.showSelectedOptionsFirst&&this.selectedValues.length&&(e=this.hasOptionGroup?this.sortOptionsGroup(e):this.sortOptions(e)),this.sortedOptions=e}},{key:"setVisibleOptions",value:function(){var e=c(this.sortedOptions),t=2*this.optionsCount,i=this.getVisibleStartIndex(),s=this.getNewOption(),o=i+t-1,n=0;s&&(s.visibleIndex=n,n++),e=e.filter((function(e){var t=!1;return e.isVisible&&!e.isCurrentNew&&(t=n>=i&&n<=o,e.visibleIndex=n,n++),t})),s&&(e=[s].concat(c(e))),this.visibleOptions=e,this.renderOptions()}},{key:"setOptionsPosition",value:function(e){void 0===e&&(e=this.getVisibleStartIndex());var t=e*this.optionHeight;this.$options.style.transform="translate3d(0, ".concat(t,"px, 0)"),r.setData(this.$options,"top",t)}},{key:"setOptionsTooltip",value:function(){var e=this,t=this.getVisibleOptions(),i=this.hasOptionDescription;t.forEach((function(t){var s=e.$dropboxContainer.querySelector('.vscomp-option[data-index="'.concat(t.index,'"]'));r.setData(s.querySelector(".vscomp-option-text"),"tooltip",t.label),i&&r.setData(s.querySelector(".vscomp-option-description"),"tooltip",t.description)}))}},{key:"setValue",value:function(e,t,i){e?Array.isArray(e)?this.selectedValues=c(e):this.selectedValues=[e]:this.selectedValues=[];var s=this.multiple?this.selectedValues:this.selectedValues[0]||"";this.$ele.value=s,this.$hiddenInput.value=s,void 0===t?this.selectedIndexes=[]:Array.isArray(t)?this.selectedIndexes=c(t):this.selectedIndexes=[t];var n=this.multiple?this.selectedIndexes:this.selectedIndexes[0]||"";if(this.$ele.index=n,this.$hiddenInput.index=n,this.isMaxValuesSelected=!!(this.maxValues&&this.maxValues<=this.selectedValues.length),this.setValueText(),this.selectedValues&&this.selectedValues[0]===f?r.removeClass(this.$wrapper,"has-value"):r.toggleClass(this.$wrapper,"has-value",o.isNotEmpty(this.selectedValues)),r.toggleClass(this.$wrapper,"max-value-selected",this.isMaxValuesSelected),i&&this.dispatchEvent(this.$ele,"change"),this.showSelectedOptionsFirst){var l=this.$optionsContainer.scrollTop;this.moveSelectedOptionsFirst(),this.$optionsContainer.scrollTop=l}}},{key:"setValueText",value:function(){var e=[],t=[],i=this.selectedValues,s=this.selectedIndexes,o=i.length,n=this.noOfDisplayValues,l=0;if(this.isAllSelected&&o>1)this.$valueText.innerHTML="".concat(o," ").concat(this.itemsSelectedMessage);else{var a,p=u(this.options);try{for(p.s();!(a=p.n()).done;){var c=a.value;if(!c.isCurrentNew){if(l>50||!this.multiple&&1===l)break;var h=c.value,d=c.label,v=c.index;if(-1!==i.indexOf(h)||-1!==s.indexOf(v)){if(l>=i.length)break;e.push(d),++l<=n&&t.push('<span class="vscomp-value-tag">'.concat(d,"</span>"))}}}}catch(e){p.e(e)}finally{p.f()}var y=o-n;y>0&&t.push('<span class="vscomp-value-tag more-value-count">+ '.concat(y," more...</span>"));var g=e.join(", ");if(""===g||i&&i[0]===f)this.$valueText.innerHTML=this.placeholder;else if(this.$valueText.innerHTML=g,this.multiple){var b=this.maxValues;if(r.hasEllipsis(this.$valueText)||b){var O="".concat(o);b&&(O+=" / ".concat(b)),this.$valueText.innerHTML="".concat(O," ").concat(this.itemsSelectedMessage)}else t=[]}}r.setData(this.$valueText,"tooltip",t.join(", "))}},{key:"setSearchValue",value:function(e,t,i){if(e!==this.searchValueOriginal||i){t||(this.$searchInput.value=e);var s=e.toLowerCase().trim();if(this.searchValue=s,this.searchValueOriginal=e,r.toggleClass(this.$wrapper,"has-search-value",e),this.appendToBody&&r.toggleClass(this.$dropboxEl,"has-search-value",e),this.hasServerSearch)this.serverSearch(s);else{var o,n=0,l=!1,a=this.isOptionVisible;this.hasOptionGroup&&(o=this.getVisibleOptionGroupsMapping(s)),this.options.forEach((function(e){if(!e.isCurrentNew){var t=a(e,s,l,o);t.isVisible&&n++,l||(l=t.hasExactOption)}})),this.allowNewOption&&(s&&!l?(this.setNewOption(),n++):this.removeNewOption()),this.visibleOptionsCount=n,this.scrollToTop(),this.setOptionsHeight(),this.setVisibleOptions(),this.afterSetSearchValue()}}}},{key:"setVisibleOptionsCount",value:function(){var e,t=0,i=!1,s=this.searchValue,o=this.showOptionsOnlyOnSearch,n=this.isOptionVisible.bind(this);this.hasOptionGroup&&(e=this.getVisibleOptionGroupsMapping(s)),this.options.forEach((function(l){var a;l.isCurrentNew||(o&&!s?(l.isVisible=!1,a={isVisible:!1,hasExactOption:!1}):a=n(l,s,i,e),a.isVisible&&t++,i||(i=a.hasExactOption))})),this.allowNewOption&&(s&&!i?(this.setNewOption(),t++):this.removeNewOption()),this.visibleOptionsCount=t,this.afterSetVisibleOptionsCount()}},{key:"setOptionProp",value:function(e,t,i){this.options[e]&&(this.options[e][t]=i)}},{key:"setOptionsHeight",value:function(){this.$optionsList.style.height=this.optionHeight*this.visibleOptionsCount+"px"}},{key:"setOptionsContainerHeight",value:function(e){var t;e?this.showAsPopup&&(this.optionsCount=this.getOptionsCount(),t=this.getOptionsHeight(),this.optionsHeight=t):(t=this.optionsHeight,this.keepAlwaysOpen&&(r.setStyle(this.$noOptions,"height",t),r.setStyle(this.$noSearchResults,"height",t))),r.setStyle(this.$optionsContainer,"max-height",t),this.afterSetOptionsContainerHeight(e)}},{key:"setDropboxPosition",value:function(){if("auto"===this.position){var e=r.getMoreVisibleSides(this.$wrapper),t=!1;if(this.dropboxWidth){var i=this.$toggleButton.getBoundingClientRect(),s=window.innerWidth,o=parseFloat(this.dropboxWidth),n=i.left+o>s,l=o>i.right;n&&!l&&(t=!0)}if(this.appendToBody){if("undefined"!=typeof screenfull&&screenfull.isFullscreen&&screenfull.element){var a=document.createDocumentFragment();a.appendChild(this.$dropboxContainer),screenfull.element.appendChild(a)}else{var p=document.createDocumentFragment();p.appendChild(this.$dropboxContainer),this.$body.appendChild(p)}var c=this.$ele.getBoundingClientRect(),u=c.left+window.scrollX,h=c.top+window.scrollY;if(this.$dropboxEl.style.width="".concat(this.dropboxWidth?parseFloat(this.dropboxWidth):c.width,"px"),this.$dropboxEl.style.left="".concat(u,"px"),"top"===e.vertical){var d=this.$dropboxContainer.getBoundingClientRect();this.$dropboxEl.style.top="".concat(h-d.height-4,"px")}else this.$dropboxEl.style.top="".concat(h+c.height+4,"px");r.toggleClass(this.$dropboxContainer,"position-top","top"===e.vertical),r.toggleClass(this.$dropboxContainer,"position-left",t)}else r.toggleClass(this.$wrapper,"position-top","top"===e.vertical),r.toggleClass(this.$wrapper,"position-left",t)}}},{key:"setNewOption",value:function(){var e=this.searchValueOriginal.trim();if(e){var t=this.getNewOption();if(t){var i=t.index;this.setOptionProp(i,"value",e),this.setOptionProp(i,"label",e)}else{var s={value:e,label:e,isCurrentNew:!0};this.addOption(s)}}}},{key:"setSelectedProp",value:function(){var e=this.selectedValues;this.options.forEach((function(t){-1!==e.indexOf(t.value)&&(t.isSelected=!0)}))}},{key:"getVisibleOptions",value:function(){return this.visibleOptions||[]}},{key:"getValue",value:function(){return this.multiple?this.selectedValues:this.selectedValues[0]}},{key:"getFirstVisibleOptionIndex",value:function(){return Math.ceil(this.$optionsContainer.scrollTop/this.optionHeight)}},{key:"getVisibleStartIndex",value:function(){var e=this.getFirstVisibleOptionIndex()-this.halfOptionsCount;return e<0&&(e=0),e}},{key:"getTooltipAttrText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s={"data-tooltip":e||"","data-tooltip-enter-delay":this.tooltipEnterDelay,"data-tooltip-z-index":this.zIndex,"data-tooltip-font-size":this.tooltipFontSize,"data-tooltip-alignment":this.tooltipAlignment,"data-tooltip-max-width":this.tooltipMaxWidth,"data-tooltip-ellipsis-only":t,"data-tooltip-allow-html":i};return r.getAttributesText(s)}},{key:"getOptionObj",value:function(e){if(e){var t=o.getString;return{index:e.index,value:t(e.value),label:t(e.label),description:t(e.description),alias:this.getAlias(e.alias),isCurrentNew:e.isCurrentNew||!1,isVisible:!0}}}},{key:"getNewOption",value:function(){var e=this.options[this.lastOptionIndex];if(e&&e.isCurrentNew)return e}},{key:"getOptionIndex",value:function(e){var t;return e&&this.options.some((function(i){if(i.value==e)return t=i.index,!0})),t}},{key:"getNewValue",value:function(){var e=this.newValues,t=this.selectedValues.filter((function(t){return-1!==e.indexOf(t)}));return this.multiple?t:t[0]}},{key:"getAlias",value:function(e){return e=e?(e=Array.isArray(e)?e.join(","):e.toString().trim()).toLowerCase():""}},{key:"getDisplayValue",value:function(){var e,t=[],i=this.selectedValues,s=u(this.options);try{for(s.s();!(e=s.n()).done;){var o=e.value;-1!==i.indexOf(o.value)&&t.push(o.label)}}catch(e){s.e(e)}finally{s.f()}return this.multiple?t:t[0]||""}},{key:"getSelectedOptions",value:function(){var e=this.selectedValues,t=[],i=this.valueKey,s=this.labelKey;return this.options.forEach((function(o){if(-1!==e.indexOf(o.value)){var n,l=(p(n={},i,o.value),p(n,s,o.label),n);o.isNew&&(l.isNew=!0),t.push(l)}})),this.multiple?t:t[0]}},{key:"getVisibleOptionGroupsMapping",value:function(e){var t=this.options,i={},s=this.isOptionVisible;return(t=this.structureOptionGroup(t)).forEach((function(t){i[t.index]=t.options.some((function(t){return s(t,e).isVisible}))})),i}},{key:"getOptionsCount",value:function(e){if(this.showAsPopup){var t=80*window.innerHeight/100-48;this.hasSearchContainer&&(t-=40),e=Math.floor(t/this.optionHeight)}else e=parseInt(e);return e}},{key:"getOptionsHeight",value:function(){return this.optionsCount*this.optionHeight+"px"}},{key:"getSibling",value:function(e,t){var i="next"===t?"nextElementSibling":"previousElementSibling";do{e&&(e=e[i])}while(r.hasClass(e,"disabled")||r.hasClass(e,"group-title"));return e}},{key:"openDropbox",value:function(e){var t=this;this.setDropboxPosition(),r.removeClass(this.$wrapper,"closed"),r.removeClass(this.$dropboxEl,"opened"),setTimeout((function(){r.addClass(t.$wrapper,"opened"),r.addClass(t.$dropboxEl,"opened"),e||(t.moveSelectedOptionsFirst(),r.addClass(t.$wrapper,"focused"),t.showAsPopup?(r.addClass(t.$body,"vscomp-popup-active"),t.isPopupActive=!0):t.focusSearchInput(),r.dispatchEvent(t.$ele,"opened"))}),0)}},{key:"closeDropbox",value:function(e){var t=this;if(this.keepAlwaysOpen)this.removeOptionFocus();else{var i=e?0:this.transitionDuration;setTimeout((function(){r.removeClass(t.$wrapper,"opened focused"),r.removeClass(t.$dropboxEl,"opened focused"),t.removeOptionFocus(),e||(t.isPopupActive&&(r.removeClass(t.$body,"vscomp-popup-active"),t.isPopupActive=!1),r.dispatchEvent(t.$ele,"closed"))}),0),setTimeout((function(){r.addClass(t.$wrapper,"closed"),r.removeClass(t.$dropboxEl,"closed"),t.appendToBody&&(t.$dropboxEl.style.left="-2000px",t.$dropboxEl.style.top="-2000px")}),i)}}},{key:"moveSelectedOptionsFirst",value:function(){this.showSelectedOptionsFirst&&(this.setSortedOptions(),this.$optionsContainer.scrollTop&&this.selectedValues.length?this.scrollToTop():this.setVisibleOptions())}},{key:"toggleDropbox",value:function(){this.isOpened()?this.closeDropbox():this.openDropbox()}},{key:"isOpened",value:function(){return r.hasClass(this.$wrapper,"opened")}},{key:"focusSearchInput",value:function(){var e=this.$searchInput;e&&e.focus()}},{key:"focusOption",value:function(e,t){var i,s=this.$dropboxContainer.querySelector(".vscomp-option.focused");if(t)i=t;else if(s)i=this.getSibling(s,e);else{var o=this.getFirstVisibleOptionIndex();i=this.$dropboxContainer.querySelector('.vscomp-option[data-visible-index="'.concat(o,'"]')),(r.hasClass(i,"disabled")||r.hasClass(i,"group-title"))&&(i=this.getSibling(i,"next"))}i&&i!==s&&(s&&r.removeClass(s,"focused"),r.addClass(i,"focused"),this.toggleFocusedProp(r.getData(i,"index"),!0),e&&this.moveFocusedOptionToView(i))}},{key:"moveFocusedOptionToView",value:function(e){if(e||(e=this.$dropboxContainer.querySelector(".vscomp-option.focused")),e){var t,i=this.$optionsContainer.getBoundingClientRect(),s=e.getBoundingClientRect(),o=i.top,n=i.bottom,l=i.height,a=s.top,p=s.bottom,c=s.height,u=e.offsetTop,h=r.getData(this.$options,"top","number");o>a?t=u+h:n<p&&(t=u-l+c+h),void 0!==t&&(this.$optionsContainer.scrollTop=t)}}},{key:"removeOptionFocus",value:function(){var e=this.$dropboxContainer.querySelector(".vscomp-option.focused");e&&(r.removeClass(e,"focused"),this.toggleFocusedProp(null))}},{key:"selectOption",value:function(e){if(e){var t=!r.hasClass(e,"selected");if(t){if(this.multiple&&this.isMaxValuesSelected)return}else if(!this.multiple)return void this.closeDropbox();var i=this.selectedValues,s=this.selectedIndexes,n=parseInt(r.getData(e,"index")),l=this.options[n].value;if(this.toggleSelectedProp(n,t),t){if(this.multiple)i.push(l),s.push(n),this.toggleAllOptionsClass();else{i.length&&this.toggleSelectedProp(this.getOptionIndex(i[0]),!1),i=[l],s=[n];var a=this.$ele.querySelector(".vscomp-option.selected");a&&r.toggleClass(a,"selected",!1),this.closeDropbox()}r.toggleClass(e,"selected")}else this.multiple&&(r.toggleClass(e,"selected"),o.removeItemFromArray(i,l),o.removeItemFromArray(s,n),this.toggleAllOptionsClass(!1));r.hasClass(e,"current-new")&&this.beforeSelectNewValue(),this.setValue(i,s,!0)}}},{key:"selectFocusedOption",value:function(){this.selectOption(this.$dropboxContainer.querySelector(".vscomp-option.focused"))}},{key:"toggleAllOptions",value:function(e){if(this.multiple&&!this.disableSelectAll){"boolean"!=typeof e&&(e=!r.hasClass(this.$toggleAllCheckbox,"checked"));var t=[],i=this.selectAllOnlyVisible;this.options.forEach((function(s,o){s.isDisabled||s.isCurrentNew||s.isGroupTitle||(!e||i&&!s.isVisible?s.isSelected=!1:(s.isSelected=!0,t.push(s.value)))})),this.toggleAllOptionsClass(e),this.setValue(t,[],!0),this.renderOptions()}}},{key:"toggleAllOptionsClass",value:function(e){if("boolean"!=typeof e){e=!1,this.options.length&&(e=!this.options.some((function(e){return!e.isSelected&&!e.isDisabled&&!e.isGroupTitle})));var t="boolean"==typeof e;t||(e=this.isAllOptionsSelected())}r.toggleClass(this.$toggleAllCheckbox,"checked",e),this.selectAllOnlyVisible&&t?this.isAllSelected=this.isAllOptionsSelected():this.isAllSelected=e}},{key:"isAllOptionsSelected",value:function(){var e=!1;return this.options.length&&(e=!this.options.some((function(e){return!e.isSelected&&!e.isDisabled&&!e.isGroupTitle}))),e}},{key:"toggleFocusedProp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.focusedOptionIndex&&this.setOptionProp(this.focusedOptionIndex,"isFocused",!1),this.setOptionProp(e,"isFocused",t),this.focusedOptionIndex=e}},{key:"toggleSelectedProp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setOptionProp(e,"isSelected",t)}},{key:"scrollToTop",value:function(){var e=!this.isOpened();e&&this.openDropbox(!0),this.$optionsContainer.scrollTop>0&&(this.$optionsContainer.scrollTop=0),e&&this.closeDropbox(!0)}},{key:"reset",value:function(){this.options.forEach((function(e){e.isSelected=!1})),this.beforeValueSet(!0),this.setValue(null,null,!0),this.afterValueSet()}},{key:"beforeValueSet",value:function(e){this.toggleAllOptionsClass(!e&&void 0)}},{key:"afterValueSet",value:function(){this.scrollToTop(),this.setSearchValue(""),this.renderOptions()}},{key:"afterSetOptions",value:function(e){var t=this.searchValue;e&&(this.isAllSelected?this.toggleAllOptions(this.isAllSelected):this.setValueMethod(this.selectedValues,this.silentInitialValueSet),this.search&&this.setSearchValue(t,!1,!0)),this.setOptionsHeight(),this.setVisibleOptions(),e||this.reset()}},{key:"addOption",value:function(e,t){if(e){this.lastOptionIndex++,e.index=this.lastOptionIndex;var i=this.getOptionObj(e);this.options.push(i),this.sortedOptions.push(i),t&&(this.visibleOptionsCount++,this.afterSetOptions())}}},{key:"removeOption",value:function(e){(e||0==e)&&(this.options.splice(e,1),this.lastOptionIndex--)}},{key:"removeNewOption",value:function(){var e=this.getNewOption();e&&this.removeOption(e.index)}},{key:"beforeSelectNewValue",value:function(){var e=this,t=this.getNewOption(),i=t.index;this.newValues.push(t.value),this.setOptionProp(i,"isCurrentNew",!1),this.setOptionProp(i,"isNew",!0),setTimeout((function(){e.setSearchValue(""),e.focusSearchInput()}),0)}},{key:"sortOptions",value:function(e){return e.sort((function(e,t){return t.value===f&&e.value!==f?0:e.isSelected||t.isSelected?e.isSelected&&(!t.isSelected||e.index<t.index)?-1:1:0}))}},{key:"sortOptionsGroup",value:function(e){var t=this.sortOptions;return(e=this.structureOptionGroup(e)).forEach((function(e){var i=e.options;e.isSelected=i.some((function(e){return e.isSelected})),e.isSelected&&t(i)})),t(e),this.destructureOptionGroup(e)}},{key:"isOptionVisible",value:function(e,t,i,s){var o=e.label.toLowerCase(),n=e.description,l=e.alias,a=-1!==o.indexOf(t);return e.isGroupTitle&&(a=s[e.index]),l&&!a&&(a=-1!==l.indexOf(t)),n&&!a&&(a=-1!==n.toLowerCase().indexOf(t)),e.isVisible=a,i||(i=o===t),{isVisible:a,hasExactOption:i}}},{key:"structureOptionGroup",value:function(e){var t=[],i={};return e.forEach((function(e){if(e.isGroupTitle){var s=[];e.options=s,i[e.index]=s,t.push(e)}})),e.forEach((function(e){e.isGroupOption&&i[e.groupIndex].push(e)})),t}},{key:"destructureOptionGroup",value:function(e){var t=[];return e.forEach((function(e){t.push(e),t=t.concat(e.options)})),t}},{key:"serverSearch",value:function(e){r.removeClass(this.$wrapper,"has-no-options"),r.addClass(this.$wrapper,"server-searching"),this.setSelectedOptions(),this.onServerSearch(e,this)}}])&&v(t.prototype,i),s&&v(t,s),e}();document.addEventListener("reset",g.resetForm),window.addEventListener("resize",g.onResizeMethod),window.VirtualSelect=g})();