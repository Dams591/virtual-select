/*!
 * Virtual Select v1.0.6
 * https://sa-si-dev.github.io/virtual-select
 * Licensed under MIT (https://github.com/sa-si-dev/virtual-select/blob/master/LICENSE)
 */(()=>{"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return t(e,i)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,(n=s.key,l=void 0,l=function(e,t){if("object"!==i(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var s=o.call(e,t||"default");if("object"!==i(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===i(l)?l:String(l)),s)}var n,l}var s=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var s,n,l;return s=t,l=[{key:"getString",value:function(e){return null!=e||0===e?e.toString():""}},{key:"convertToBoolean",value:function(e){return e=!0===e||"true"===e||!1!==e&&"false"!==e&&arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},{key:"isEmpty",value:function(e){var t=!1;return e?Array.isArray(e)?0===e.length&&(t=!0):"object"===i(e)&&0===Object.keys(e).length&&(t=!0):t=!0,t}},{key:"isNotEmpty",value:function(e){return!this.isEmpty(e)}},{key:"removeItemFromArray",value:function(t,i,o){if(!Array.isArray(t)||!t.length)return t;o&&(t=e(t));var s=t.indexOf(i);return-1!==s&&t.splice(s,1),t}},{key:"removeArrayEmpty",value:function(e){return Array.isArray(e)&&e.length?e.filter((function(e){return!!e})):[]}},{key:"generateUUID",value:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}}],(n=null)&&o(s.prototype,n),l&&o(s,l),Object.defineProperty(s,"prototype",{writable:!1}),t}();function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function l(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function r(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(s=o.key,l=void 0,l=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(s,"string"),"symbol"===n(l)?l:String(l)),o)}var s,l}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,o;return t=e,o=[{key:"addClass",value:function(t,i){t&&(i=i.split(" "),e.getElements(t).forEach((function(e){var t;(t=e.classList).add.apply(t,l(i))})))}},{key:"removeClass",value:function(t,i){t&&(i=i.split(" "),e.getElements(t).forEach((function(e){var t;(t=e.classList).remove.apply(t,l(i))})))}},{key:"toggleClass",value:function(t,i,o){var s;if(t)return void 0!==o&&(o=Boolean(o)),e.getElements(t).forEach((function(e){s=e.classList.toggle(i,o)})),s}},{key:"hasClass",value:function(e,t){return!!e&&e.classList.contains(t)}},{key:"hasEllipsis",value:function(e){return!!e&&e.scrollWidth>e.offsetWidth}},{key:"getData",value:function(e,t,i){if(e){var o=e?e.dataset[t]:"";return"number"===i&&(o=parseFloat(o)||0),o}}},{key:"setData",value:function(e,t,i){e&&(e.dataset[t]=i)}},{key:"setAttr",value:function(e,t,i){e&&e.setAttribute(t,i)}},{key:"setAttrFromEle",value:function(e,t,i,o){var s={};i.forEach((function(t){s[t]=e.getAttribute(t)})),i.forEach((function(e){var i=s[e];(i||-1!==o.indexOf(e)&&""===i)&&t.setAttribute(e,i)}))}},{key:"setStyle",value:function(e,t,i){e&&(e.style[t]=i)}},{key:"setStyles",value:function(e,t){e&&t&&Object.keys(t).forEach((function(i){e.style[i]=t[i]}))}},{key:"getElements",value:function(e){if(e)return void 0===e.forEach&&(e=[e]),e}},{key:"addEvent",value:function(t,i,o){t&&(i=s.removeArrayEmpty(i.split(" "))).forEach((function(i){(t=e.getElements(t)).forEach((function(e){e.addEventListener(i,o)}))}))}},{key:"dispatchEvent",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t&&(t=e.getElements(t),setTimeout((function(){t.forEach((function(e){e.dispatchEvent(new CustomEvent(i,{bubbles:o}))}))}),0))}},{key:"getAttributesText",value:function(e){var t="";if(!e)return t;for(var i in e){var o=e[i];void 0!==o&&(t+=" ".concat(i,'="').concat(o,'" '))}return t}},{key:"getStyleText",value:function(e,t){var i="";for(var o in e)i+="".concat(o,": ").concat(e[o],";");return i&&!t&&(i='style="'.concat(i,'"')),i}},{key:"getMoreVisibleSides",value:function(e){if(!e)return{};var t=e.getBoundingClientRect(),i=window.innerWidth,o=window.innerHeight,s=t.left,n=t.top;return{horizontal:s>i-s-t.width?"left":"right",vertical:n>o-n-t.height?"top":"bottom"}}}],(i=null)&&r(t.prototype,i),o&&r(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function u(e,t,i){return(t=g(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=v(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var o=0,s=function(){};return{s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){a=!0,n=e},f:function(){try{l||null==i.return||i.return()}finally{if(a)throw n}}}}function v(e,t){if(e){if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function y(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,g(o.key),o)}}function g(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var o=i.call(e,t||"default");if("object"!==p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===p(t)?t:String(t)}var b="{#virtual-select-none-option#}",m={13:"onEnterPress",27:"onEscPress",38:"onUpArrowPress",40:"onDownArrowPress"},O=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);try{this.setProps(t),this.setDisabledOptions(t.disabledOptions),this.setOptions(t.options),this.render()}catch(e){console.warn("Couldn't initiate Virtual Select"),console.error(e)}}var t,i,o;return t=e,i=[{key:"render",value:function(){var e=this;if(this.$ele){var t="vscomp-wrapper",i=this.getTooltipAttrText("",!this.multiple,!0),o=this.getTooltipAttrText("Clear"),n={"z-index":this.zIndex},l=function(){var t="";return e.additionalClasses&&(t+=" "+e.additionalClasses),e.multiple&&(t+=" multiple",e.disableSelectAll||(t+=" has-select-all")),"top"===e.position&&(t+=" position-top"),e.hideClearButton||(t+=" has-clear-button"),e.keepAlwaysOpen?t+=" keep-always-open opened":t+=" closed",e.showAsPopup?t+=" show-as-popup":e.dropboxWidth&&(n.width=e.dropboxWidth),e.hasSearch&&(t+=" has-search-input"),t};t+=l(),this.guid=s.generateUUID();var a='<div id="vs-'.concat(this.guid,'" class="vscomp-dropbox-container" ').concat(c.getStyleText(n),'>\n      <div class="vscomp-dropbox">\n        <div class="vscomp-search-wrapper"></div>\n\n        <div class="vscomp-options-container">\n          <div class="vscomp-options-loader"></div>\n\n          <div class="vscomp-options-list">\n            <div class="vscomp-options"></div>\n          </div>\n        </div>\n\n        <div class="vscomp-no-options">').concat(this.noOptionsText,'</div>\n        <div class="vscomp-no-search-results">').concat(this.noSearchResultsText,'</div>\n\n        <span class="vscomp-dropbox-close-button"><i class="vscomp-clear-icon"></i></span>\n      </div>\n    </div>'),r='<div class="'.concat(t,'" tabindex="0">\n        <input type="hidden" name="').concat(this.name,'" class="vscomp-hidden-input">\n\n        <div class="vscomp-toggle-button">\n          <div class="vscomp-value" ').concat(i,">\n            ").concat(this.placeholder,'\n          </div>\n\n          <div class="vscomp-arrow"></div>\n\n          <div class="vscomp-clear-button toggle-button-child" ').concat(o,'>\n            <i class="vscomp-clear-icon"></i>\n          </div>\n        </div>\n\n        ').concat(this.keepAlwaysOpen||!this.appendToBody?a:"","\n\n      </div>");if(this.$ele.innerHTML=r,this.$body=document.querySelector("body"),this.$wrapper=this.$ele.querySelector(".vscomp-wrapper"),this.$toggleButton=this.$ele.querySelector(".vscomp-toggle-button"),this.$clearButton=this.$ele.querySelector(".vscomp-clear-button"),this.$dropboxCloseButton=this.$ele.querySelector(".vscomp-dropbox-close-button"),!this.keepAlwaysOpen&&this.appendToBody){this.$body.append(document.createRange().createContextualFragment(a)),this.$dropboxContainer=document.querySelector("#vs-".concat(this.guid,".vscomp-dropbox-container")),this.$dropboxEl=document.querySelector("#vs-".concat(this.guid));var p="vscomp-wrapper-body";p+=l(),c.addClass(this.$dropboxEl,"".concat(p))}else this.$dropboxContainer=this.$ele.querySelector(".vscomp-dropbox-container"),this.$dropboxEl=this.$ele;this.$search=this.$dropboxEl.querySelector(".vscomp-search-wrapper"),this.$optionsContainer=this.$dropboxEl.querySelector(".vscomp-options-container"),this.$optionsList=this.$dropboxEl.querySelector(".vscomp-options-list"),this.$options=this.$dropboxEl.querySelector(".vscomp-options"),this.$valueText=this.$ele.querySelector(".vscomp-value"),this.$hiddenInput=this.$ele.querySelector(".vscomp-hidden-input"),this.$noOptions=this.$dropboxEl.querySelector(".vscomp-no-options"),this.$noSearchResults=this.$dropboxEl.querySelector(".vscomp-no-search-results"),this.afterRenderWrapper()}}},{key:"renderOptions",value:function(){var e,t=this,i="",o=this.getVisibleOptions(),s="",n="",l=!(!this.markSearchResults||!this.searchValue),a=c.getStyleText({height:this.optionHeight+"px"});if(l&&(e=new RegExp("(".concat(this.searchValue,")"),"gi")),this.multiple&&(s='<span class="checkbox-icon"></span>'),this.allowNewOption){var r=this.getTooltipAttrText("New Option");n='<span class="vscomp-new-option-icon" '.concat(r,"></span>")}o.forEach((function(o){var r=o.label,c="vscomp-option",p=t.getTooltipAttrText("",!0),u=s,h="",d="";o.classNames&&(c+=" ".concat(o.classNames)),o.isFocused&&(c+=" focused"),o.isDisabled&&(c+=" disabled"),o.isGroupTitle?(c+=" group-title",u=""):o.isSelected&&(c+=" selected"),o.isGroupOption&&(c+=" group-option"),o.description&&(d='<div class="vscomp-option-description" '.concat(p,">").concat(o.description,"</div>")),o.isCurrentNew?(c+=" current-new",h+=n):l&&!o.isGroupTitle&&(r=r.replace(e,"<mark>$1</mark>")),i+='<div class="'.concat(c,'" data-value="').concat(o.value,'" data-index="').concat(o.index,'" data-visible-index="').concat(o.visibleIndex,'" ').concat(a,">\n          ").concat(u,'\n          <span title="').concat(r,'" class="vscomp-option-text ').concat(o.value===b?"none":"",'" ').concat(p,">\n            ").concat(r,"\n          </span>\n          ").concat(d,"\n          ").concat(h,"\n        </div>")})),this.$options.innerHTML=i;var p=!this.options.length,u=!p&&!o.length;this.allowNewOption||(c.toggleClass(this.$wrapper,"has-no-search-results",u),this.appendToBody&&c.toggleClass(this.$dropboxEl,"has-no-search-results",u)),c.toggleClass(this.$wrapper,"has-no-options",p),this.setOptionsPosition(),this.setOptionsTooltip()}},{key:"renderSearch",value:function(){if(this.hasSearchContainer){var e="",t="";this.hasSearch&&(t=' <div class="vscomp-search-container">\n          <input type="text" class="vscomp-search-input" placeholder="'.concat(this.searchPlaceholder,'">\n          <span class="vscomp-search-clear">&times;</span>\n        </div>')),this.multiple&&!this.disableSelectAll&&(e='<div class="vs-comp-select-all-container">\n        <span class="vscomp-toggle-all-button">\n          <span class="checkbox-icon vscomp-toggle-all-checkbox"></span>\n          <span class="vscomp-toggle-all-label">'.concat(this.selectAllText,"</span>\n        </span>\n        </div>")),this.hasSearch&&this.multiple&&this.addSeachToSelection&&(e+='<div class="vs-comp-select-add-search-container">\n        <span class="vscomp-toggle-add-search-button">\n          <span class="checkbox-icon vscomp-toggle-add-search-checkbox"></span>\n          <span class="vscomp-toggle-add-search-label">'.concat(this.addSearchToSelectionText,"</span>\n        </span>\n        </div>"));var i="".concat(t).concat(e);this.$search.innerHTML=i,this.$searchInput=this.$dropboxEl.querySelector(".vscomp-search-input"),this.$searchClear=this.$dropboxEl.querySelector(".vscomp-search-clear"),this.$toggleAllButton=this.$dropboxEl.querySelector(".vscomp-toggle-all-button"),this.$toggleAllCheckbox=this.$dropboxEl.querySelector(".vscomp-toggle-all-checkbox"),this.$toggleAddSeachContainer=this.$dropboxEl.querySelector(".vs-comp-select-add-search-container"),this.$toggleAddSeachButton=this.$dropboxEl.querySelector(".vscomp-toggle-add-search-button"),this.$toggleAddSeachCheckbox=this.$dropboxEl.querySelector(".vscomp-toggle-add-search-checkbox"),this.addEvent(this.$searchInput,"keyup change","onSearch"),this.addEvent(this.$searchClear,"click","onSearchClear"),this.addEvent(this.$toggleAllButton,"click","onToggleAllOptions"),this.addEvent(this.$toggleAddSeachButton,"click","onAddSeachToSelection")}}},{key:"addEvents",value:function(){this.addEvent(document,"click","onDocumentClick"),this.addEvent(this.$wrapper,"keydown","onKeyDown"),this.addEvent(this.$toggleButton,"click","onToggleButtonClick"),this.addEvent(this.$clearButton,"click","onClearButtonClick"),this.addEvent(this.$dropboxContainer,"click","onDropboxContainerClick"),this.addEvent(this.$dropboxCloseButton,"click","onDropboxCloseButtonClick"),this.addEvent(this.$optionsContainer,"scroll","onOptionsScroll"),this.addEvent(this.$options,"click","onOptionsClick"),this.addEvent(this.$options,"mouseover","onOptionsMouseOver"),this.addEvent(this.$dropboxContainer,"mouseleave","onOptionsMouseLeave"),this.addEvent(this.$options,"touchmove","onOptionsTouchMove")}},{key:"onOptionsMouseLeave",value:function(){this.removeOptionFocus()}},{key:"addEvent",value:function(e,t,i){var o=this;e&&(t=s.removeArrayEmpty(t.split(" "))).forEach((function(t){var s="".concat(i,"-").concat(t),n=o.events[s];n||(n=o[i].bind(o),o.events[s]=n),(e=c.getElements(e)).forEach((function(e){e.addEventListener(t,n)}))}))}},{key:"dispatchEvent",value:function(e,t){e&&(e=c.getElements(e),setTimeout((function(){e.forEach((function(e){e.dispatchEvent(new Event(t,{bubbles:!0}))}))}),0))}},{key:"onDocumentClick",value:function(e){this.appendToBody&&this.multiple&&this.isOpened()&&e.target.closest("#vs-".concat(this.guid))||e.target.closest(".vscomp-wrapper")!==this.$wrapper&&this.closeDropbox()}},{key:"onKeyDown",value:function(e){var t=e.which||e.keyCode,i=m[t];i&&this[i](e)}},{key:"onEnterPress",value:function(){this.isOpened()?this.selectFocusedOption():this.openDropbox()}},{key:"onEscPress",value:function(){this.isOpened()&&this.closeDropbox()}},{key:"onDownArrowPress",value:function(e){e.preventDefault(),this.isOpened()?this.focusOption("next"):this.openDropbox()}},{key:"onUpArrowPress",value:function(e){e.preventDefault(),this.isOpened()?this.focusOption("previous"):this.openDropbox()}},{key:"onToggleButtonClick",value:function(e){e.target.closest(".toggle-button-child")||this.toggleDropbox()}},{key:"onClearButtonClick",value:function(){this.reset()}},{key:"onOptionsScroll",value:function(){this.setVisibleOptions()}},{key:"onOptionsClick",value:function(e){if(this.selectOption(e.target.closest(".vscomp-option:not(.disabled):not(.group-title)")),this.multiple&&this.showSelectedOptionsFirst)return e.stopPropagation(),!1}},{key:"onDropboxContainerClick",value:function(e){e.target.closest(".vscomp-dropbox")||this.closeDropbox()}},{key:"onDropboxCloseButtonClick",value:function(){this.closeDropbox()}},{key:"onOptionsMouseOver",value:function(e){var t=e.target.closest(".vscomp-option:not(.disabled):not(.group-title)");t&&this.isOpened()&&this.focusOption(null,t)}},{key:"onOptionsTouchMove",value:function(){this.removeOptionFocus()}},{key:"onSearch",value:function(e){e.stopPropagation(),this.setSearchValue(e.target.value,!0)}},{key:"onSearchClear",value:function(){this.setSearchValue(""),this.focusSearchInput()}},{key:"onToggleAllOptions",value:function(){this.toggleAllOptions()}},{key:"onAddSeachToSelection",value:function(){if(this.multiple&&this.searchValue){var e=!c.hasClass(this.$toggleAddSeachCheckbox,"checked"),t=this.selectedValues,i=this.options.filter((function(e){if(!(e.isDisabled||e.isCurrentNew||e.isGroupTitle))return e.isVisible}));if(e){var o,s=d(i);try{for(s.s();!(o=s.n()).done;){var n=o.value;-1===t.indexOf(n.value)&&(n.isSelected=!0,t.push(n.value))}}catch(e){s.e(e)}finally{s.f()}}else{var l,a=d(i);try{for(a.s();!(l=a.n()).done;){var r=l.value,p=t.indexOf(r.value);-1!==p&&(r.isSelected=!1,t.splice(p,1))}}catch(e){a.e(e)}finally{a.f()}}this.toggleAddSearchClass(e),this.toggleAllOptionsClass(e),this.setValue(t,[],!0),this.renderOptions()}}},{key:"onResize",value:function(){this.appendToBody?this.isOpened()&&this.closeDropbox(!0):this.setOptionsContainerHeight(!0)}},{key:"beforeValueSet",value:function(e){this.toggleAllOptionsClass(!e&&void 0)}},{key:"beforeSelectNewValue",value:function(){var e=this,t=this.getNewOption(),i=t.index;this.newValues.push(t.value),this.setOptionProp(i,"isCurrentNew",!1),this.setOptionProp(i,"isNew",!0),setTimeout((function(){e.setSearchValue(""),e.focusSearchInput()}),0)}},{key:"afterRenderWrapper",value:function(){this.$ele.setAttribute("name",this.name),c.addClass(this.$ele,"vscomp-ele"),this.renderSearch(),this.setOptionsHeight(),this.setVisibleOptions(),this.setOptionsContainerHeight(),this.addEvents(),this.setMethods(),void 0!==this.initialSelectedValue&&null!==this.initialSelectedValue?this.setValueMethod(this.initialSelectedValue,this.silentInitialValueSet):this.autoSelectFirstOption&&this.visibleOptions.length&&this.setValueMethod(this.visibleOptions[0].value,this.silentInitialValueSet)}},{key:"afterSetOptionsContainerHeight",value:function(e){e&&this.showAsPopup&&this.setVisibleOptions()}},{key:"afterSetSearchValue",value:function(){this.hasServerSearch?this.serverSearch():this.setVisibleOptionsCount(),this.selectAllOnlyVisible&&this.toggleAllOptionsClass(),this.addSeachToSelection&&this.toggleAddSearchClass()}},{key:"afterSetVisibleOptionsCount",value:function(){this.scrollToTop(),this.setOptionsHeight(),this.setVisibleOptions()}},{key:"afterValueSet",value:function(){this.scrollToTop(),this.setSearchValue(""),this.renderOptions()}},{key:"afterSetOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.searchValue;e&&(this.isAllSelected?this.toggleAllOptions(this.isAllSelected,t):this.setValueMethod(this.selectedValues,t||this.silentInitialValueSet),this.search&&this.setSearchValue(i,!1,!0)),this.setOptionsHeight(),this.setVisibleOptions(),e||this.reset()}},{key:"setProps",value:function(e){e=this.setDefaultProps(e),this.setPropsFromElementAttr(e);var t=s.convertToBoolean;this.$ele=e.ele,this.valueKey=e.valueKey,this.labelKey=e.labelKey,this.descriptionKey=e.descriptionKey,this.aliasKey=e.aliasKey,this.optionHeightText=e.optionHeight,this.optionHeight=parseFloat(this.optionHeightText),this.multiple=t(e.multiple),this.hasSearch=t(e.search),this.hideClearButton=t(e.hideClearButton),this.autoSelectFirstOption=t(e.autoSelectFirstOption),this.hasOptionDescription=t(e.hasOptionDescription),this.silentInitialValueSet=t(e.silentInitialValueSet),this.allowNewOption=t(e.allowNewOption),this.markSearchResults=t(e.markSearchResults),this.showSelectedOptionsFirst=t(e.showSelectedOptionsFirst),this.putUnAvailableOptionsLast=t(e.putUnAvailableOptionsLast),this.disableSelectAll=t(e.disableSelectAll),this.keepAlwaysOpen=t(e.keepAlwaysOpen),this.showDropboxAsPopup=t(e.showDropboxAsPopup),this.selectAllOnlyVisible=t(e.selectAllOnlyVisible),this.noOptionsText=e.noOptionsText,this.noSearchResultsText=e.noSearchResultsText,this.selectAllText=e.selectAllText,this.addSearchToSelectionText=e.addSearchToSelectionText,this.placeholder=e.placeholder,this.position=e.position,this.dropboxWidth=e.dropboxWidth,this.tooltipFontSize=e.tooltipFontSize,this.tooltipAlignment=e.tooltipAlignment,this.tooltipMaxWidth=e.tooltipMaxWidth,this.noOfDisplayValues=parseInt(e.noOfDisplayValues),this.zIndex=parseInt(e.zIndex),this.maxValues=parseInt(e.maxValues),this.name=e.name,this.additionalClasses=e.additionalClasses,this.initialSelectedValue=e.selectedValue,this.popupDropboxBreakpoint=e.popupDropboxBreakpoint,this.onServerSearch=e.onServerSearch,this.searchPlaceholder=e.searchPlaceholder,this.itemsSelectedMessage=e.itemsSelectedMessage,this.allowNoneOption=e.allowNoneOption,this.noneOptionText=e.noneOptionText,this.appendToBody=e.appendToBody,this.addSeachToSelection=t(e.addSeachToSelection),this.searchCallback=e.searchCallback||null,this.selectedValues=[],this.selectedIndexes=[],this.selectedOptions=[],this.newValues=[],this.events={},this.tooltipEnterDelay=200,this.transitionDuration=250,this.searchValue="",this.searchValueOriginal="",this.isAllSelected=!1,(void 0===e.search&&this.multiple||this.allowNewOption)&&(this.hasSearch=!0),this.maxValues&&(this.disableSelectAll=!0),this.hasServerSearch="function"==typeof this.onServerSearch,this.showAsPopup=this.showDropboxAsPopup&&!this.keepAlwaysOpen&&window.innerWidth<=parseFloat(this.popupDropboxBreakpoint),this.hasSearchContainer=this.hasSearch||this.multiple&&!this.disableSelectAll,this.optionsCount=this.getOptionsCount(e.optionsCount),this.halfOptionsCount=Math.ceil(this.optionsCount/2),this.optionsHeight=this.getOptionsHeight()}},{key:"setDefaultProps",value:function(e){var t={valueKey:"value",labelKey:"label",descriptionKey:"description",aliasKey:"alias",optionsCount:5,noOfDisplayValues:50,optionHeight:"40px",multiple:!1,hideClearButton:!1,autoSelectFirstOption:!1,hasOptionDescription:!1,silentInitialValueSet:!1,disableSelectAll:!1,noOptionsText:"No options found",noSearchResultsText:"No results found",selectAllText:"Select All",placeholder:"Select",position:"auto",zIndex:1,allowNewOption:!1,markSearchResults:!1,tooltipFontSize:"14px",tooltipAlignment:"center",tooltipMaxWidth:"300px",showSelectedOptionsFirst:!1,putUnAvailableOptionsLast:!1,name:"",additionalClasses:"",keepAlwaysOpen:!1,maxValues:0,showDropboxAsPopup:!0,popupDropboxBreakpoint:"576px",searchPlaceholder:"Search...",itemsSelectedMessage:"selected",allowNoneOption:!1,noneOptionText:"None",appendToBody:!1,selectAllOnlyVisible:!0,addSeachToSelection:!1,addSearchToSelectionText:"Add to selection"};return e.hasOptionDescription&&(t.optionsCount=4,t.optionHeight="60px"),Object.assign(t,e)}},{key:"setPropsFromElementAttr",value:function(e){var t=e.ele,i={multiple:"multiple",placeholder:"placeholder",name:"name","data-value-key":"valueKey","data-label-key":"labelKey","data-description-key":"descriptionKey","data-alias-key":"aliasKey","data-search":"search","data-hide-clear-button":"hideClearButton","data-auto-select-first-option":"autoSelectFirstOption","data-has-option-description":"hasOptionDescription","data-options-count":"optionsCount","data-option-height":"optionHeight","data-position":"position","data-no-options-text":"noOptionsText","data-no-search-results-text":"noSearchResultsText","data-select-all-text":"selectAllText","data-silent-initial-value-set":"silentInitialValueSet","data-dropbox-width":"dropboxWidth","data-z-index":"zIndex","data-no-of-display-values":"noOfDisplayValues","data-allow-new-option":"allowNewOption","data-mark-search-results":"markSearchResults","data-tooltip-font-size":"tooltipFontSize","data-tooltip-alignment":"tooltipAlignment","data-tooltip-max-width":"tooltipMaxWidth","data-show-selected-options-first":"showSelectedOptionsFirst","data-put-un-available-options-last":"putUnAvailableOptionsLast","data-disable-select-all":"disableSelectAll","data-keep-always-open":"keepAlwaysOpen","data-max-values":"maxValues","data-additional-classes":"additionalClasses","data-show-dropbox-as-popup":"showDropboxAsPopup","data-popup-dropbox-breakpoint":"popupDropboxBreakpoint","data-select-all-only-visible":"selectAllOnlyVisible"};for(var o in i){var s=t.getAttribute(o);"multiple"!==o||""!==s&&"true"!==s||(s=!0),s&&(e[i[o]]=s)}}},{key:"setMethods",value:function(){var t=this.$ele;t.virtualSelect=this,t.value=this.multiple?[]:"",t.reset=e.reset,t.renderOptions=e.renderOptions,t.setValue=e.setValueMethod,t.setOptions=e.setOptionsMethod,t.setDisabledOptions=e.setDisabledOptionsMethod,t.toggleSelectAll=e.toggleSelectAll,t.isAllSelected=e.isAllSelected,t.addOption=e.addOptionMethod,t.getNewValue=e.getNewValueMethod,t.getDisplayValue=e.getDisplayValueMethod,t.open=e.openMethod,t.close=e.closeMethod,t.setSearchValue=e.setSearchValueMethod}},{key:"setValueMethod",value:function(e,t){Array.isArray(e)||(e=[e]),e=e.map((function(e){return e||0==e?e.toString():""}));var i,o=[],s=[],n=new Set([]),l=new Set(e),a=d(this.options);try{for(a.s();!(i=a.n()).done;){var r=i.value;if(!l.has(r.value)||r.isDisabled||r.isGroupTitle)r.isSelected=!1;else{if(n.has(r.value)&&this.multiple)break;if(r.isSelected=!0,n.add(r.value),o.push(r.value),s.push(r.index),!this.multiple)break}}}catch(e){a.e(e)}finally{a.f()}this.multiple||(o=o[0],s=s[0]),this.beforeValueSet(),this.setValue(o,s,!t),this.afterValueSet()}},{key:"setOptionsMethod",value:function(e,t,i){this.options,this.setOptions(e),this.afterSetOptions(t,i)}},{key:"setDisabledOptionsMethod",value:function(e){this.setDisabledOptions(e,!0),this.setValueMethod(null),this.setVisibleOptions()}},{key:"setDisabledOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e.map((function(e){return e.toString()})),this.disabledOptions=e,t&&e.length&&this.options.forEach((function(t){return t.isDisabled=-1!==e.indexOf(t.value),t}))}},{key:"setOptions",value:function(e){e||(e=[]);var t=[],i=this.disabledOptions,o=i.length,n=this.valueKey,l=this.labelKey,a=this.descriptionKey,r=this.aliasKey,c=this.hasOptionDescription,p=s.getString,u=s.convertToBoolean,h=this.getAlias,d=0,v=!1;!this.multiple&&this.allowNoneOption&&e.unshift({value:b,label:this.noneOptionText}),e.forEach((function e(s){var f=p(s[n]),y=s.options,g=!!y,b={index:d,value:f,label:p(s[l]),alias:h(s[r]),isVisible:u(s.isVisible,!0),isGroupTitle:g,classNames:s.classNames};if(o&&(b.isDisabled=-1!==i.indexOf(f)),s.isGroupOption&&(b.isGroupOption=!0,b.groupIndex=s.groupIndex),c&&(b.description=p(s[a])),t.push(b),d++,g){var m=b.index;v=!0,y.forEach((function(t){t.isGroupOption=!0,t.groupIndex=m,e(t)}))}})),this.options=t,this.visibleOptionsCount=t.length,this.lastOptionIndex=this.options.length-1,this.newValues=[],this.hasOptionGroup=v,this.setSortedOptions()}},{key:"setServerOptions",value:function(e){var t=this;this.setOptionsMethod(e,!0);var i=this.selectedOptions,o=this.options,s=!1;if(i.length){var n=o.map((function(e){return e.value}));s=!0,i.forEach((function(e){-1===n.indexOf(e.value)&&(e.isVisible=!1,o.push(e))})),this.setOptionsMethod(o,!0)}this.allowNewOption&&this.searchValue&&(o.some((function(e){return e.label.toLowerCase()===t.searchValue}))||(s=!0,this.setNewOption())),s&&(this.setVisibleOptionsCount(),this.multiple&&this.toggleAllOptionsClass(),this.addSeachToSelection&&this.toggleAddSearchClass(),this.setValueText()),c.removeClass(this.$wrapper,"server-searching")}},{key:"setSelectedOptions",value:function(){var e=this.selectedValues;this.selectedOptions=this.options.filter((function(t){return-1!==e.indexOf(t.value)}))}},{key:"setSortedOptions",value:function(){var e=h(this.options);this.showSelectedOptionsFirst&&this.selectedValues.length&&(e=this.hasOptionGroup?this.sortOptionsGroup(e):this.sortOptions(e)),this.putUnAvailableOptionsLast&&(e=e.sort((function(e,t){return void 0===e.classNames&&void 0!==t.classNames?-1:void 0!==e.classNames&&void 0===t.classNames?1:0}))),this.sortedOptions=e}},{key:"setVisibleOptions",value:function(){var e=h(this.sortedOptions),t=2*this.optionsCount,i=this.getVisibleStartIndex(),o=this.getNewOption(),s=i+t-1,n=0;o&&(o.visibleIndex=n,n++),e=e.filter((function(e){var t=!1;return e.isVisible&&!e.isCurrentNew&&(t=n>=i&&n<=s,e.visibleIndex=n,n++),t})),o&&(e=[o].concat(h(e))),this.visibleOptions=e,this.renderOptions()}},{key:"setOptionsPosition",value:function(e){void 0===e&&(e=this.getVisibleStartIndex());var t=e*this.optionHeight;this.$options.style.transform="translate3d(0, ".concat(t,"px, 0)"),c.setData(this.$options,"top",t)}},{key:"setOptionsTooltip",value:function(){var e=this,t=this.getVisibleOptions(),i=this.hasOptionDescription;t.forEach((function(t){var o=e.$dropboxContainer.querySelector('.vscomp-option[data-index="'.concat(t.index,'"]'));c.setData(o.querySelector(".vscomp-option-text"),"tooltip",t.label),i&&c.setData(o.querySelector(".vscomp-option-description"),"tooltip",t.description)}))}},{key:"setValue",value:function(e,t,i){e?Array.isArray(e)?this.selectedValues=h(e):this.selectedValues=[e]:this.selectedValues=[];var o=this.multiple?this.selectedValues:this.selectedValues[0]||"";this.$ele.value=o,this.$hiddenInput.value=o,void 0===t?this.selectedIndexes=[]:Array.isArray(t)?this.selectedIndexes=h(t):this.selectedIndexes=[t];var n="";if(this.multiple?n=this.selectedIndexes:null!==this.selectedIndexes[0]&&void 0!==this.selectedIndexes[0]&&(n=this.selectedIndexes[0]),this.$ele.index=n,this.$hiddenInput.index=n,this.isMaxValuesSelected=!!(this.maxValues&&this.maxValues<=this.selectedValues.length),this.setValueText(),this.selectedValues&&this.selectedValues[0]===b?c.removeClass(this.$wrapper,"has-value"):c.toggleClass(this.$wrapper,"has-value",s.isNotEmpty(this.selectedValues)),c.toggleClass(this.$wrapper,"max-value-selected",this.isMaxValuesSelected),i&&this.dispatchEvent(this.$ele,"change"),this.showSelectedOptionsFirst){var l=this.$optionsContainer.scrollTop;this.moveSelectedOptionsFirst(),this.$optionsContainer.scrollTop=l}}},{key:"setValueText",value:function(){var e=[],t=[],i=this.selectedValues,o=this.selectedIndexes,s=i.length,n=this.noOfDisplayValues,l=0;if(this.isAllSelected&&s>1)this.$valueText.innerHTML="".concat(s," ").concat(this.itemsSelectedMessage);else{var a,r=d(this.options);try{for(r.s();!(a=r.n()).done;){var p=a.value;if(!p.isCurrentNew){if(l>50||!this.multiple&&1===l)break;var u=p.value,h=p.label,v=p.index;if(-1!==i.indexOf(u)||-1!==o.indexOf(v)){if(l>=i.length)break;e.push(h),++l<=n&&t.push('<span class="vscomp-value-tag">'.concat(h,"</span>"))}}}}catch(e){r.e(e)}finally{r.f()}var f=s-n;f>0&&t.push('<span class="vscomp-value-tag more-value-count">+ '.concat(f," more...</span>"));var y=e.join(", ");if(""===y||i&&i[0]===b)this.$valueText.innerHTML=this.placeholder;else if(this.$valueText.innerHTML=y,this.multiple){var g=this.maxValues;if(c.hasEllipsis(this.$valueText)||g){var m="".concat(s);g&&(m+=" / ".concat(g)),this.$valueText.innerHTML="".concat(m," ").concat(this.itemsSelectedMessage)}else t=[]}}c.setData(this.$valueText,"tooltip",t.join(", "))}},{key:"setSearchValue",value:function(e,t,i){if(e!==this.searchValueOriginal||i){t||(this.$searchInput.value=e);var o=e.toLowerCase().trim();if(this.searchValue=o,this.searchValueOriginal=e,c.toggleClass(this.$wrapper,"has-search-value",e),this.appendToBody&&c.toggleClass(this.$dropboxEl,"has-search-value",e),this.hasServerSearch)this.serverSearch(o);else{var s,n=0,l=!1,a=this.isOptionVisible;this.hasOptionGroup&&(s=this.getVisibleOptionGroupsMapping(o)),this.options.forEach((function(e){if(!e.isCurrentNew){var t=a(e,o,l,s);t.isVisible&&n++,l||(l=t.hasExactOption)}})),this.allowNewOption&&(o&&!l?(this.setNewOption(),n++):this.removeNewOption()),this.visibleOptionsCount=n,this.scrollToTop(),this.setOptionsHeight(),this.setVisibleOptions(),this.afterSetSearchValue(),this.searchCallback&&this.searchCallback(o)}}}},{key:"setVisibleOptionsCount",value:function(){var e,t=0,i=!1,o=this.searchValue,s=this.showOptionsOnlyOnSearch,n=this.isOptionVisible.bind(this);this.hasOptionGroup&&(e=this.getVisibleOptionGroupsMapping(o)),this.options.forEach((function(l){var a;l.isCurrentNew||(s&&!o?(l.isVisible=!1,a={isVisible:!1,hasExactOption:!1}):a=n(l,o,i,e),a.isVisible&&t++,i||(i=a.hasExactOption))})),this.allowNewOption&&(o&&!i?(this.setNewOption(),t++):this.removeNewOption()),this.visibleOptionsCount=t,this.afterSetVisibleOptionsCount()}},{key:"setOptionProp",value:function(e,t,i){this.options[e]&&(this.options[e][t]=i)}},{key:"setOptionsHeight",value:function(){this.$optionsList.style.height=this.optionHeight*this.visibleOptionsCount+"px"}},{key:"setOptionsContainerHeight",value:function(e){var t;e?this.showAsPopup&&(this.optionsCount=this.getOptionsCount(),t=this.getOptionsHeight(),this.optionsHeight=t):(t=this.optionsHeight,this.keepAlwaysOpen&&(c.setStyle(this.$noOptions,"height",t),c.setStyle(this.$noSearchResults,"height",t))),c.setStyle(this.$optionsContainer,"max-height",t),this.afterSetOptionsContainerHeight(e)}},{key:"setDropboxPosition",value:function(){if("auto"===this.position){var e=c.getMoreVisibleSides(this.$wrapper),t=!1;if(this.dropboxWidth){var i=this.$toggleButton.getBoundingClientRect(),o=window.innerWidth,s=parseFloat(this.dropboxWidth),n=i.left+s>o,l=s>i.right;n&&!l&&(t=!0)}if(this.appendToBody){if("undefined"!=typeof screenfull&&screenfull.isFullscreen&&screenfull.element){var a=document.createDocumentFragment();a.appendChild(this.$dropboxContainer),screenfull.element.appendChild(a)}else{var r=document.createDocumentFragment();r.appendChild(this.$dropboxContainer),this.$body.appendChild(r)}var p=this.$ele.getBoundingClientRect(),u=p.left+window.scrollX,h=p.top+window.scrollY;if(this.$dropboxEl.style.width="".concat(this.dropboxWidth?parseFloat(this.dropboxWidth):p.width,"px"),this.$dropboxEl.style.left="".concat(u,"px"),"top"===e.vertical){var d=this.$dropboxContainer.getBoundingClientRect();this.$dropboxEl.style.top="".concat(h-d.height-4,"px")}else this.$dropboxEl.style.top="".concat(h+p.height+4,"px");c.toggleClass(this.$dropboxContainer,"position-top","top"===e.vertical),c.toggleClass(this.$dropboxContainer,"position-left",t)}else c.toggleClass(this.$wrapper,"position-top","top"===e.vertical),c.toggleClass(this.$wrapper,"position-left",t)}}},{key:"setNewOption",value:function(){var e=this.searchValueOriginal.trim();if(e){var t=this.getNewOption();if(t){var i=t.index;this.setOptionProp(i,"value",e),this.setOptionProp(i,"label",e)}else{var o={value:e,label:e,isCurrentNew:!0};this.addOption(o)}}}},{key:"setSelectedProp",value:function(){var e=this.selectedValues;this.options.forEach((function(t){-1!==e.indexOf(t.value)&&(t.isSelected=!0)}))}},{key:"getVisibleOptions",value:function(){return this.visibleOptions||[]}},{key:"getValue",value:function(){return this.multiple?this.selectedValues:this.selectedValues[0]}},{key:"getFirstVisibleOptionIndex",value:function(){return Math.ceil(this.$optionsContainer.scrollTop/this.optionHeight)}},{key:"getVisibleStartIndex",value:function(){var e=this.getFirstVisibleOptionIndex()-this.halfOptionsCount;return e<0&&(e=0),e}},{key:"getTooltipAttrText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o={"data-tooltip":e||"","data-tooltip-enter-delay":this.tooltipEnterDelay,"data-tooltip-z-index":this.zIndex,"data-tooltip-font-size":this.tooltipFontSize,"data-tooltip-alignment":this.tooltipAlignment,"data-tooltip-max-width":this.tooltipMaxWidth,"data-tooltip-ellipsis-only":t,"data-tooltip-allow-html":i};return c.getAttributesText(o)}},{key:"getOptionObj",value:function(e){if(e){var t=s.getString;return{index:e.index,value:t(e.value),label:t(e.label),description:t(e.description),alias:this.getAlias(e.alias),isCurrentNew:e.isCurrentNew||!1,isVisible:!0}}}},{key:"getNewOption",value:function(){var e=this.options[this.lastOptionIndex];if(e&&e.isCurrentNew)return e}},{key:"getOptionIndex",value:function(e){var t;return e&&this.options.some((function(i){if(i.value==e)return t=i.index,!0})),t}},{key:"getNewValue",value:function(){var e=this.newValues,t=this.selectedValues.filter((function(t){return-1!==e.indexOf(t)}));return this.multiple?t:t[0]}},{key:"getAlias",value:function(e){return e=e?(e=Array.isArray(e)?e.join(","):e.toString().trim()).toLowerCase():""}},{key:"getDisplayValue",value:function(){var e,t=[],i=this.selectedValues,o=d(this.options);try{for(o.s();!(e=o.n()).done;){var s=e.value;-1!==i.indexOf(s.value)&&t.push(s.label)}}catch(e){o.e(e)}finally{o.f()}return this.multiple?t:t[0]||""}},{key:"getSelectedOptions",value:function(){var e=this.selectedValues,t=[],i=this.valueKey,o=this.labelKey;return this.options.forEach((function(s){if(-1!==e.indexOf(s.value)){var n,l=(u(n={},i,s.value),u(n,o,s.label),n);s.isNew&&(l.isNew=!0),t.push(l)}})),this.multiple?t:t[0]}},{key:"getVisibleOptionGroupsMapping",value:function(e){var t=this.options,i={},o=this.isOptionVisible;return(t=this.structureOptionGroup(t)).forEach((function(t){i[t.index]=t.options.some((function(t){return o(t,e).isVisible}))})),i}},{key:"getOptionsCount",value:function(e){if(this.showAsPopup){var t=80*window.innerHeight/100-48;this.hasSearchContainer&&(t-=40),e=Math.floor(t/this.optionHeight)}else e=parseInt(e);return e}},{key:"getOptionsHeight",value:function(){return this.optionsCount*this.optionHeight+"px"}},{key:"getSibling",value:function(e,t){var i="next"===t?"nextElementSibling":"previousElementSibling";do{e&&(e=e[i])}while(c.hasClass(e,"disabled")||c.hasClass(e,"group-title"));return e}},{key:"openDropbox",value:function(e){var t=this;this.setDropboxPosition(),c.removeClass(this.$wrapper,"closed"),c.removeClass(this.$dropboxEl,"opened"),setTimeout((function(){c.addClass(t.$wrapper,"opened"),c.addClass(t.$dropboxEl,"opened"),e||(t.moveSelectedOptionsFirst(),c.addClass(t.$wrapper,"focused"),t.showAsPopup?(c.addClass(t.$body,"vscomp-popup-active"),t.isPopupActive=!0):t.focusSearchInput(),c.dispatchEvent(t.$ele,"opened"))}),0)}},{key:"closeDropbox",value:function(e){var t=this;if(this.keepAlwaysOpen)this.removeOptionFocus();else{var i=e?0:this.transitionDuration;setTimeout((function(){c.removeClass(t.$wrapper,"opened focused"),c.removeClass(t.$dropboxEl,"opened focused"),t.removeOptionFocus(),e||(t.isPopupActive&&(c.removeClass(t.$body,"vscomp-popup-active"),t.isPopupActive=!1),c.dispatchEvent(t.$ele,"closed"))}),0),setTimeout((function(){c.addClass(t.$wrapper,"closed"),c.removeClass(t.$dropboxEl,"closed"),t.appendToBody&&(t.$dropboxEl.style.left="-2000px",t.$dropboxEl.style.top="-2000px")}),i)}}},{key:"moveSelectedOptionsFirst",value:function(){this.showSelectedOptionsFirst&&(this.setSortedOptions(),this.$optionsContainer.scrollTop&&this.selectedValues.length?this.scrollToTop():this.setVisibleOptions())}},{key:"toggleDropbox",value:function(){this.isOpened()?this.closeDropbox():this.openDropbox()}},{key:"isOpened",value:function(){return c.hasClass(this.$wrapper,"opened")}},{key:"focusSearchInput",value:function(){var e=this.$searchInput;e&&e.focus()}},{key:"focusOption",value:function(e,t){var i,o=this.$dropboxContainer.querySelector(".vscomp-option.focused");if(t)i=t;else if(o)i=this.getSibling(o,e);else{var s=this.getFirstVisibleOptionIndex();i=this.$dropboxContainer.querySelector('.vscomp-option[data-visible-index="'.concat(s,'"]')),(c.hasClass(i,"disabled")||c.hasClass(i,"group-title"))&&(i=this.getSibling(i,"next"))}i&&i!==o&&(o&&c.removeClass(o,"focused"),c.addClass(i,"focused"),this.toggleFocusedProp(c.getData(i,"index"),!0),e&&this.moveFocusedOptionToView(i))}},{key:"moveFocusedOptionToView",value:function(e){if(e||(e=this.$dropboxContainer.querySelector(".vscomp-option.focused")),e){var t,i=this.$optionsContainer.getBoundingClientRect(),o=e.getBoundingClientRect(),s=i.top,n=i.bottom,l=i.height,a=o.top,r=o.bottom,p=o.height,u=e.offsetTop,h=c.getData(this.$options,"top","number");s>a?t=u+h:n<r&&(t=u-l+p+h),void 0!==t&&(this.$optionsContainer.scrollTop=t)}}},{key:"removeOptionFocus",value:function(){var e=this.$dropboxContainer.querySelector(".vscomp-option.focused");e&&(c.removeClass(e,"focused"),this.toggleFocusedProp(null))}},{key:"selectOption",value:function(e){if(e){var t=!c.hasClass(e,"selected");if(t){if(this.multiple&&this.isMaxValuesSelected)return}else if(!this.multiple)return void this.closeDropbox();var i=this.selectedValues,o=this.selectedIndexes,n=parseInt(c.getData(e,"index")),l=this.options[n].value;if(this.toggleSelectedProp(n,t),t){if(this.multiple)i.push(l),o.push(n),this.toggleAllOptionsClass();else{i.length&&this.toggleSelectedProp(this.getOptionIndex(i[0]),!1),i=[l],o=[n];var a=this.$ele.querySelector(".vscomp-option.selected");a&&c.toggleClass(a,"selected",!1),this.closeDropbox()}c.toggleClass(e,"selected")}else this.multiple&&(c.toggleClass(e,"selected"),s.removeItemFromArray(i,l),s.removeItemFromArray(o,n),this.toggleAllOptionsClass(!1));c.hasClass(e,"current-new")&&this.beforeSelectNewValue(),this.setValue(i,o,!0)}}},{key:"selectFocusedOption",value:function(){this.selectOption(this.$dropboxContainer.querySelector(".vscomp-option.focused"))}},{key:"toggleAllOptions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.multiple&&!this.disableSelectAll){"boolean"!=typeof e&&(e=!c.hasClass(this.$toggleAllCheckbox,"checked"));var i=[],o=[],s=this.selectAllOnlyVisible;this.options.forEach((function(t,n){t.isDisabled||t.isCurrentNew||t.isGroupTitle||(!e||s&&!t.isVisible?t.isSelected=!1:(t.isSelected=!0,i.push(t.value),s&&!t.isVisible||o.push(n)))})),this.toggleAllOptionsClass(e),this.toggleAddSearchClass(e),this.setValue(i,o,!t),this.renderOptions()}}},{key:"toggleAllOptionsClass",value:function(e){if("boolean"!=typeof e){e=!1,this.options.length&&(e=!this.options.some((function(e){return!e.isSelected&&!e.isDisabled&&!e.isGroupTitle})));var t="boolean"==typeof e;t||(e=this.isAllOptionsSelected())}c.toggleClass(this.$toggleAllCheckbox,"checked",e),this.selectAllOnlyVisible&&t?this.isAllSelected=this.isAllOptionsSelected():this.isAllSelected=e}},{key:"toggleAddSearchClass",value:function(e){var t=this.getVisibleOptions();c.toggleClass(this.$toggleAddSeachContainer,"hidden",!t||!t.length),"boolean"!=typeof e&&(e=!1,this.options.length&&(e=!this.options.some((function(e){return e.isVisible&&!e.isSelected&&!e.isDisabled&&!e.isGroupTitle}))),"boolean"==typeof e||(e=!1)),c.toggleClass(this.$toggleAddSeachCheckbox,"checked",e)}},{key:"isAllOptionsSelected",value:function(){var e=!1;return this.options.length&&(e=!this.options.some((function(e){return!e.isSelected&&!e.isDisabled&&!e.isGroupTitle}))),e}},{key:"toggleFocusedProp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.focusedOptionIndex&&this.setOptionProp(this.focusedOptionIndex,"isFocused",!1),this.setOptionProp(e,"isFocused",t),this.focusedOptionIndex=e}},{key:"toggleSelectedProp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setOptionProp(e,"isSelected",t)}},{key:"scrollToTop",value:function(){var e=!this.isOpened();e&&this.openDropbox(!0),this.$optionsContainer.scrollTop>0&&(this.$optionsContainer.scrollTop=0),e&&this.closeDropbox(!0)}},{key:"reset",value:function(){this.options.forEach((function(e){e.isSelected=!1})),this.beforeValueSet(!0),this.setValue(null,null,!0),this.afterValueSet()}},{key:"addOption",value:function(e,t){if(e){this.lastOptionIndex++,e.index=this.lastOptionIndex;var i=this.getOptionObj(e);this.options.push(i),this.sortedOptions.push(i),t&&(this.visibleOptionsCount++,this.afterSetOptions())}}},{key:"removeOption",value:function(e){(e||0==e)&&(this.options.splice(e,1),this.lastOptionIndex--)}},{key:"removeNewOption",value:function(){var e=this.getNewOption();e&&this.removeOption(e.index)}},{key:"sortOptions",value:function(e){return e.sort((function(e,t){return t.value===b&&e.value!==b?0:e.isSelected||t.isSelected?e.isSelected&&(!t.isSelected||e.index<t.index)?-1:1:0}))}},{key:"sortOptionsGroup",value:function(e){var t=this.sortOptions;return(e=this.structureOptionGroup(e)).forEach((function(e){var i=e.options;e.isSelected=i.some((function(e){return e.isSelected})),e.isSelected&&t(i)})),t(e),this.destructureOptionGroup(e)}},{key:"isOptionVisible",value:function(e,t,i,o){var s=e.label.toLowerCase(),n=e.description,l=e.alias,a=-1!==s.indexOf(t);return e.isGroupTitle&&(a=o[e.index]),l&&!a&&(a=-1!==l.indexOf(t)),n&&!a&&(a=-1!==n.toLowerCase().indexOf(t)),e.isVisible=a,i||(i=s===t),{isVisible:a,hasExactOption:i}}},{key:"structureOptionGroup",value:function(e){var t=[],i={};return e.forEach((function(e){if(e.isGroupTitle){var o=[];e.options=o,i[e.index]=o,t.push(e)}})),e.forEach((function(e){e.isGroupOption&&i[e.groupIndex].push(e)})),t}},{key:"destructureOptionGroup",value:function(e){var t=[];return e.forEach((function(e){t.push(e),t=t.concat(e.options)})),t}},{key:"serverSearch",value:function(e){c.removeClass(this.$wrapper,"has-no-options"),c.addClass(this.$wrapper,"server-searching"),this.setSelectedOptions(),this.onServerSearch(e,this)}}],o=[{key:"init",value:function(t){var i=t.ele;if(i){var o=!1;if("string"!=typeof i||(i=document.querySelector(i))){void 0===i.length&&(i=[i],o=!0);var s=[];return i.forEach((function(i){t.ele=i,s.push(new e(t))})),o?s[0]:s}}}},{key:"resetForm",value:function(e){var t=e.target.closest("form");t&&t.querySelectorAll(".vscomp-wrapper").forEach((function(e){e.parentElement.virtualSelect.reset()}))}},{key:"reset",value:function(){this.virtualSelect.reset()}},{key:"renderOptions",value:function(){this.virtualSelect.renderOptions()}},{key:"setValueMethod",value:function(e,t){this.virtualSelect.setValueMethod(e,t)}},{key:"setOptionsMethod",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.virtualSelect.setOptionsMethod(e,t,i)}},{key:"setDisabledOptionsMethod",value:function(e){this.virtualSelect.setDisabledOptionsMethod(e)}},{key:"toggleSelectAll",value:function(e){this.virtualSelect.toggleAllOptions(e)}},{key:"isAllSelected",value:function(){return this.virtualSelect.isAllSelected}},{key:"addOptionMethod",value:function(e){this.virtualSelect.addOption(e,!0)}},{key:"getNewValueMethod",value:function(){return this.virtualSelect.getNewValue()}},{key:"version",value:function(){return"v1.0.6"}},{key:"getDisplayValueMethod",value:function(){return this.virtualSelect.getDisplayValue()}},{key:"getSelectedOptionsMethod",value:function(){return this.virtualSelect.getSelectedOptions()}},{key:"openMethod",value:function(){return this.virtualSelect.openDropbox()}},{key:"closeMethod",value:function(){return this.virtualSelect.closeDropbox()}},{key:"setSearchValueMethod",value:function(e){return this.virtualSelect.setSearchValue(e)}},{key:"onResizeMethod",value:function(){document.querySelectorAll(".vscomp-wrapper").forEach((function(e){e.parentElement.virtualSelect.onResize()}))}}],i&&y(t.prototype,i),o&&y(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();document.addEventListener("reset",O.resetForm),window.addEventListener("resize",O.onResizeMethod),window.VirtualSelect=O})();